{"componentChunkName":"component---src-templates-post-index-tsx","path":"/posts/DevOps/CI&CD/github_actions_argoCD/","result":{"data":{"markdownRemark":{"id":"038327b7-454e-5f16-bf59-11f5e4eb625f","html":"<h1 id=\"1-cicd-구상도\" style=\"position:relative;\"><a href=\"#1-cicd-%EA%B5%AC%EC%83%81%EB%8F%84\" aria-label=\"1 cicd 구상도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. CI/CD 구상도</h1>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/2a0d198805269f712bedd7266d8f0863/2bef9/github_actions_argoCD.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 61.71428571428571%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACFklEQVR42nVS2XLaMBTlK/tVfeKRh+a9YfGCA2axzeKmTlhaIDSDwYTgxODKrktsD1alUUce0XEZ8nBmpKurc885c3MYY4EQwhNCOIYyIaTCahQC6znVhOzbGfgcJZlOpy1N0zSEUM1xnK6736l+hGvPPpZpE8akCgBQj8e4jgkRtr+RHENcvUAopISSJPUKhYJhmmZXEMVduyE/PK6d5vWM3K1/Qnk2/T5qKYo7uO1NugtP/cCFuwc3adO/+AIhH0VR1bZtmdk62eY3blSPEyIhBEVW56MEVWfPoPWO5ZRQgBDyQRCkOSKERDakrrSbm5eX7Rc26PSJC8BePKv9r9A0zftOp/PkeV7n1AghlEaj8f3hcGhm1dBB8/m87/t+85JKSlixLEvXdf0xSZL6qQlCKFxdXelBENDweaZcAAAohmFMNpuN/h5hajkMQy5jmXMcp5bP58eiKPYRQjzLNc3W80Bqma1TCoSJ+M9yHMdVx3HqGSUV27b7kiSB8Xg8Wa1W6nA4/LZcLr/SYT+Wq9rZ7tJz6bSHgizLXcMwlOyCQghvkiRpQAhrCKGb/X6vLRYL1QVA3YzutmF8bLquqwJ3r9hu1Cjroen+Qo0cxlgcDAaqaZpNRiYyCGcZUSWVMAi0t+qnwPN91bKs26e12RvOnd7H0lu0dP50qMJiBqUsMMbl7BnjNMMi8V451v+ZoUgwpvfrvzBQVB1jH5GBAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/2a0d198805269f712bedd7266d8f0863/c54d4/github_actions_argoCD.webp 175w,\n/TIL/static/2a0d198805269f712bedd7266d8f0863/a3432/github_actions_argoCD.webp 350w,\n/TIL/static/2a0d198805269f712bedd7266d8f0863/426ac/github_actions_argoCD.webp 700w,\n/TIL/static/2a0d198805269f712bedd7266d8f0863/a9a89/github_actions_argoCD.webp 1024w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/2a0d198805269f712bedd7266d8f0863/4edbd/github_actions_argoCD.png 175w,\n/TIL/static/2a0d198805269f712bedd7266d8f0863/13ae7/github_actions_argoCD.png 350w,\n/TIL/static/2a0d198805269f712bedd7266d8f0863/8c557/github_actions_argoCD.png 700w,\n/TIL/static/2a0d198805269f712bedd7266d8f0863/2bef9/github_actions_argoCD.png 1024w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/2a0d198805269f712bedd7266d8f0863/8c557/github_actions_argoCD.png\"\n            alt=\"CI/CD 구상도\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>개인적으로 CI/CD를 구축하는 데 있어 가장 큰 어려움은, 기술적인 난이도보다 전체 아키텍쳐 구성의 이해에 있는 것 같다. 위 아키텍쳐의 실제 동작 순서는 아래와 같다.</p>\n<ol>\n<li>Github 레포지토리에 이벤트가 발생한다.</li>\n<li>Gtihub Actions 워크플로우가 동작한다.\n<ol>\n<li>프로젝트를 Docker 이미지로 빌드하고 DockerHub에 푸시한다.</li>\n<li>argoCD가 바라보는 타겟 폴더의 yaml 파일을 업데이트 한다.</li>\n</ol>\n</li>\n<li>argoCD가 변화를 자동으로 감지하고, 쿠버네티스 클러스터를 업데이트 한다.</li>\n</ol>\n<h2 id=\"11-argocd-란\" style=\"position:relative;\"><a href=\"#11-argocd-%EB%9E%80\" aria-label=\"11 argocd 란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.1. argoCD 란?</h2>\n<p>argoCD는 <mark>git 레포지토리의 어플리케이션 상태에 쿠버네티스 클러스터를 동기화시키는 도구</mark>이다. argoCD가 git 레포지토리의 특정 브랜치의 특정 폴더를 바라보도록 할 수 있다. 만일 해당 경로에 쿠버네티스 설정(yml)파일이 있다면, argoCD는 이를 자동으로 클러스터에 배포한다. 또한 기본값으로 3분마다 파일 변화를 관측하여 클러스터를 동기화한다.</p>\n<p>argoCD는 이 모든 설정이 의심스러울 정도로 간단한다. Jenkins를 사용할 때는 git에서 Webhook을 날리기 위해 상호 간 token을 등록해야 했는데, argoCD는 그런 것도 없다. argoCD 측에서 일방적으로 git 레포지토리를 관측하도록 설정할 수 있다.</p>\n<h2 id=\"12-kustomize-란\" style=\"position:relative;\"><a href=\"#12-kustomize-%EB%9E%80\" aria-label=\"12 kustomize 란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.2. kustomize 란?</h2>\n<p>kustomize는 <mark>원본 쿠버네티스 설정 파일을 유지한 채, 손쉬운 편집을 도와주는 도구</mark>이다. git이 업데이트 되면 프로젝트가 다시 빌드되고 도커 이미지 버전이 업데이트된다. 그러면 쿠버네티스 설정 파일의 이미지 버전 또한 수정해줘야한다. 다른 설정은 유지한 채 어떻게 이미지 버전만 업데이트할 수 있을까? CLI 명령어로 장인정신을 발휘해야하나 고민하던 찰나 kustomize를 알게 되었다.</p>\n<p><strong>argoCD에는 기본적으로 kustomize가 탑재되어 있다.</strong> 따라서 타겟 폴더에 <code>kustomization.yml</code>파일이 있다면, 자동으로 <code>kustomize</code> 명령어를 활용해서 클러스터를 동기화한다.</p>\n<h3 id=\"121-도커-이미지-업데이트\" style=\"position:relative;\"><a href=\"#121-%EB%8F%84%EC%BB%A4-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8\" aria-label=\"121 도커 이미지 업데이트 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.2.1. 도커 이미지 업데이트</h3>\n<p>kustomize로 기존 설정파일을 유지한 채 손쉽게 이미지 버전을 업데이트 할 수 있다. 아래와 같이 설정파일을 작성하고 <code>kustomize</code> 명령어를 실행하면 8.0버전의 mySQL 파드가 실행된다.</p>\n<pre><code class=\"language-yml\"># mysql.yml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: mysql-dp\n\nspec:\n  selector:\n    matchLabels:\n      app: mysql\n  template:\n    metadata:\n      labels:\n        app: mysql\n    spec:\n      containers:\n        - image: mysql:latest\n          name: mysql\n          env:\n            - name: MYSQL_ROOT_PASSWORD\n              value: 'password'\n\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: mysql-svc\nspec:\n  ports:\n    - port: 3306\n  selector:\n    app: mysql\n</code></pre>\n<pre><code class=\"language-yml\"># kustomization.yml\napiVersion: kustomize.config.k8s.io/v1beta1\nkind: Kustomization\n\nresources:\n  - mysql.yml # 타겟 파일\n\nimages:\n  - name: mysql\n    newTag: 8.0 # 타겟 태그\n</code></pre>\n<pre><code class=\"language-bash\">kubectl kustomize { kustomization 파일 위치 }\n</code></pre>\n<h1 id=\"2-argocd-구성\" style=\"position:relative;\"><a href=\"#2-argocd-%EA%B5%AC%EC%84%B1\" aria-label=\"2 argocd 구성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. argoCD 구성</h1>\n<p>argoCD를 구성하기 위해서는 사전에 쿠버네티스 클러스터가 구성되어 있어야 한다. <a href=\"https://argo-cd.readthedocs.io/en/stable/getting_started/\">argoCD 공식문서</a>를 따라 argoCD를 설치한다.</p>\n<h2 id=\"21-argocd-설치\" style=\"position:relative;\"><a href=\"#21-argocd-%EC%84%A4%EC%B9%98\" aria-label=\"21 argocd 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.1. argoCD 설치</h2>\n<p><code>argocd</code> 네임스페이스를 생성하여 argoCD 관련 리소스를 모아 관리한다.</p>\n<pre><code class=\"language-bash\">kubectl create namespace argocd\nkubectl apply -n argocd -f https://raw.githubusercontent.com/argoproj/argo-cd/stable/manifests/install.yaml\n</code></pre>\n<h2 id=\"22-argocd-노출\" style=\"position:relative;\"><a href=\"#22-argocd-%EB%85%B8%EC%B6%9C\" aria-label=\"22 argocd 노출 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.2. argoCD 노출</h2>\n<p>argoCD 웹 대쉬보드에 접근하기 위해서는 서비스를 외부로 노출시켜야 한다. <a href=\"https://argo-cd.readthedocs.io/en/stable/getting_started/#3-access-the-argo-cd-api-server\">공식문서</a> 상황에 따라 다양한 방법을 알려주고 있다. 나는 k3s의 Traefik Ingress를 사용했기 때문에 <a href=\"https://argo-cd.readthedocs.io/en/stable/operator-manual/ingress/#ingressroute-crd\">IngressRoute</a>를 띄워 접근하려고 했으나 잘 동작하지 않았다. (지금 다시 보니까 URL prefix 관련 설정을 커스텀하지 않아서일 수도...)</p>\n<p>고민 끝에 다음과 같은 임시방편을 사용했다. 아래 명령어를 돌리면 외부에서 임시적으로 웹 대시보드에 접근할 수 있다. 하지만 CLI 프로세스가 중지되면 곧바로 닫힌다. 참고로 웹 대시보드에 접근하지 못할 뿐이지 argoCD는 정상 작동한다.</p>\n<pre><code class=\"language-bash\"># \"IP주소:8080\"로 접근\nkubectl port-forward --address=0.0.0.0 svc/argocd-server -n argocd 8080:443\n</code></pre>\n<h2 id=\"23-argocd-로그인\" style=\"position:relative;\"><a href=\"#23-argocd-%EB%A1%9C%EA%B7%B8%EC%9D%B8\" aria-label=\"23 argocd 로그인 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.3. argoCD 로그인</h2>\n<p>기본 ID는 <code>admin</code>이고, 비밀번호는 아래 명령어로 찾을 수 있다.</p>\n<pre><code class=\"language-bash\">kubectl get secret -n argocd argocd-initial-admin-secret -o jsonpath=\"{.data.password}\" | base64 -d\n</code></pre>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/4f1dd/argoCD_login.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAACa0lEQVR42m3QWVNSARiHcT5OU+4Csu8HDvsmghtIIqQiiKBgKm65pJNOY9NFF32rbrrtqplmSjFDQp7mHBptJt8P8Jv/+yiePPPxtC9Iz0CE3sFReofG6BuO069MMKSZZliTRKmdQW2YRWvOorfOozHl8EaqXDVuoH1L+8snOjdXSKd42h+iZyBK31BMRqzOHKK/gMtXwB0s4Y+sEoxV8YZX0dsWMApL6Gx5ArENLi+vabWa3F19o9NudUFpVb8yzqB6nKGRKdSGGbTmWTSmDCrzCwy2eUxCHpNQwCgUsIgljMIyocQ2P2Twlg4Pp5BWDaonUWqSqPTSa8/l90xikUSsjNm9gsGex+xcxiKuYPNUsIgVopP7XF795LZ1y1377gGUVil1KdSGtLxKZ55DZc1TKZ3w/d0ay/ljdK5V7J4ydu8aQmAdm7dGLHlIQ2oItNrtB1ClTzNizHSDS+85FlHZipSzdb6+LbGS3UYnVnH6aziDG4jhOkJgi8TM6T1487t9/7ZCa5pDZ5FaLcrBLa4iBrHCYiLP54KL/MQytuAWYmgTMVLHM7qHGNllInNO4/qXjHQ6DxUVeusCRscSJmdRDm51l3H4qmTn6mzNl8lld/FEd3BHd/DF9gnED/HEDpjOXTwOmhyFbnB3N7jdV0Xw17D717GH6jhDdbyje/jiBwQSR4QmTwgkXpOaf0/juvk/aHGVsEqQFPyfTu7INp7oLv6xV/gTRwTHjwlPnhJNnhGeOiOd//A4aPes4fDVEIIvcYU2cYe35U7esX388UMZklaFp98QTZ0TS18QTV2QKX7k+i/YbDbv0T9rYSXmZsRCcQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/c54d4/argoCD_login.webp 175w,\n/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/a3432/argoCD_login.webp 350w,\n/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/426ac/argoCD_login.webp 700w,\n/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/c139f/argoCD_login.webp 1050w,\n/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/7f403/argoCD_login.webp 1400w,\n/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/991ad/argoCD_login.webp 1567w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/4edbd/argoCD_login.png 175w,\n/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/13ae7/argoCD_login.png 350w,\n/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/8c557/argoCD_login.png 700w,\n/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/e996b/argoCD_login.png 1050w,\n/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/2cefc/argoCD_login.png 1400w,\n/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/4f1dd/argoCD_login.png 1567w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/2f23902a51e3f409a0a33f8caf0069ca/8c557/argoCD_login.png\"\n            alt=\"argoCD 로그인 화면\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h1 id=\"3-cicd-구축\" style=\"position:relative;\"><a href=\"#3-cicd-%EA%B5%AC%EC%B6%95\" aria-label=\"3 cicd 구축 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. CI/CD 구축</h1>\n<h2 id=\"31-argocd-타겟-브랜치-생성\" style=\"position:relative;\"><a href=\"#31-argocd-%ED%83%80%EA%B2%9F-%EB%B8%8C%EB%9E%9C%EC%B9%98-%EC%83%9D%EC%84%B1\" aria-label=\"31 argocd 타겟 브랜치 생성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.1. argoCD 타겟 브랜치 생성</h2>\n<p>타겟 브랜치란 argoCD가 쿠버네티스가 클러스트 동기화를 위해 바라보는 곳이다. 소스 코드가 빌드된 뒤에 타겟 브랜치에 있는 <code>yaml</code>파일이 업데이트 된다. 원본 소스코드 레포지토리와 동일해도 상관은 없지만, 나는 커밋 내역을 분리하기 위해 별도 브랜치를 생성했다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/736c810cf222e540c3adc86a1e80449b/e405b/argo-target-branch.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 55.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABv0lEQVR42m1SS2/TQBjc38sNcUICUQS1ve+XUblw4dATEieOvRQOgIBLaSAuhARVqFRB4iU1aVIP+tbeJFWxNBpbHn8734xZwTW27hWopEHBFYR2CVzZhPxcSQvSkk5o32OtVTqgKh2YEBqV0JCGXq4HSGN77qCMX91rF6FtSFA2QBqPW+V93OElmFAGXBpYH1dwoYaiA8ihMv/Fpl67gGu3b+D63Ztg2vregYM2PrFxAfvPX+Bw8AHDYYPm6FOH5gifRyO8efsOxnXDMtf1Q9RxB4xLnVYl+6YXEEZfJjhfLLBcLpGvtm0TT6c/kobMkDtFTBG4ACaMByFnkga7iIPDAX7++o2z2Qyz2Rzz+TkuFt3wk5PTlB1ln7LVXcZ0AKOcKMPsLGM8+XrJVXvR4vvfKSZ/vqE5HsH6uo8nXjLCqMlSudSU2mjt5avXGI8nKbuPwwYH7wd4vPcE208DHj3bhXV1+oVI2/0N3ZZM2IhC+VTEZnO0Brkn3i4likrAuweo/U5i0uuNb2hd4/qBXPsrK9NKGcYESCouF9BrUik2pvxUdshNRKGvOlwhRGjtUXKVNMZ3WREr2xuxa4f/AGwrcg8abB1yAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/736c810cf222e540c3adc86a1e80449b/c54d4/argo-target-branch.webp 175w,\n/TIL/static/736c810cf222e540c3adc86a1e80449b/a3432/argo-target-branch.webp 350w,\n/TIL/static/736c810cf222e540c3adc86a1e80449b/426ac/argo-target-branch.webp 700w,\n/TIL/static/736c810cf222e540c3adc86a1e80449b/c139f/argo-target-branch.webp 1050w,\n/TIL/static/736c810cf222e540c3adc86a1e80449b/7f403/argo-target-branch.webp 1400w,\n/TIL/static/736c810cf222e540c3adc86a1e80449b/9b2c8/argo-target-branch.webp 1566w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/736c810cf222e540c3adc86a1e80449b/4edbd/argo-target-branch.png 175w,\n/TIL/static/736c810cf222e540c3adc86a1e80449b/13ae7/argo-target-branch.png 350w,\n/TIL/static/736c810cf222e540c3adc86a1e80449b/8c557/argo-target-branch.png 700w,\n/TIL/static/736c810cf222e540c3adc86a1e80449b/e996b/argo-target-branch.png 1050w,\n/TIL/static/736c810cf222e540c3adc86a1e80449b/2cefc/argo-target-branch.png 1400w,\n/TIL/static/736c810cf222e540c3adc86a1e80449b/e405b/argo-target-branch.png 1566w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/736c810cf222e540c3adc86a1e80449b/8c557/argo-target-branch.png\"\n            alt=\"argoCD 타겟 브랜치 생성\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p>그리고 <code>/config/deploy</code> 경로에 프로젝트마다 폴더를 만들어 yml파일이 관리했다. 참고로 우리는 프론트 1개, 백엔드 게이트웨이 1개, 스프링부트 MSA 3개 총 5개의 프로젝트를 관리했다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/a93257966d829e050e7478ca111913ad/cd7c1/argo-target-folder.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABMklEQVR42q2SPU8cQRBE9///HyICIhKLCAnZICEfkGC4273Z6fnsnnloxxeYzOJoqTTRPFVX13RYVnbPf5hd5n0OrKHgY2aVxBoSEhMSEosT3pcji/NIzIRUkJNyrtRshFmZRITV7fD+Cece8X6Pl0g4gWbJSMrkXIgpE1OiqmLNSLkQQubx7YXLh2tuXu6YvAiH5Sci94Twi5T2xKRUa+RqzFFJ1TBr6ElVbbwSIs557l9/c3F3xY+nW6ZSCvtjxq0VbWCtY9bHhw3SW/sE+1e1KqZG731IizK11nA+sa0Ona/MANJxq2PaHEiq+FA4d7z3m0MjJB0uvwVoZiPkNWRMlWZ/M/kyUNW2EMbK3gdKqWy5ngHUcUUbdWi0fubKpVYOxzBKvDlTs/9Uw9pnbZ3+AJF1XrRs7nRcAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/a93257966d829e050e7478ca111913ad/c54d4/argo-target-folder.webp 175w,\n/TIL/static/a93257966d829e050e7478ca111913ad/a3432/argo-target-folder.webp 350w,\n/TIL/static/a93257966d829e050e7478ca111913ad/426ac/argo-target-folder.webp 700w,\n/TIL/static/a93257966d829e050e7478ca111913ad/c139f/argo-target-folder.webp 1050w,\n/TIL/static/a93257966d829e050e7478ca111913ad/7f403/argo-target-folder.webp 1400w,\n/TIL/static/a93257966d829e050e7478ca111913ad/0dd1a/argo-target-folder.webp 1547w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/a93257966d829e050e7478ca111913ad/4edbd/argo-target-folder.png 175w,\n/TIL/static/a93257966d829e050e7478ca111913ad/13ae7/argo-target-folder.png 350w,\n/TIL/static/a93257966d829e050e7478ca111913ad/8c557/argo-target-folder.png 700w,\n/TIL/static/a93257966d829e050e7478ca111913ad/e996b/argo-target-folder.png 1050w,\n/TIL/static/a93257966d829e050e7478ca111913ad/2cefc/argo-target-folder.png 1400w,\n/TIL/static/a93257966d829e050e7478ca111913ad/cd7c1/argo-target-folder.png 1547w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/a93257966d829e050e7478ca111913ad/8c557/argo-target-folder.png\"\n            alt=\"argoCD 타겟 폴더 생성\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"311-react-예시\" style=\"position:relative;\"><a href=\"#311-react-%EC%98%88%EC%8B%9C\" aria-label=\"311 react 예시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.1.1. React 예시</h3>\n<pre><code class=\"language-yml\"># react.yml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: react-dp\nspec:\n  selector:\n    matchLabels:\n      app: react\n  template:\n    metadata:\n      labels:\n        app: react\n    spec:\n      containers:\n        - image: byongho/gallery-react:1.0.0\n          name: react\n          ports:\n            - containerPort: 80\n\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: react-svc\nspec:\n  ports:\n    - port: 80\n  selector:\n    app: react\n</code></pre>\n<pre><code class=\"language-yml\"># kustomization.yml\napiVersion: kustomize.config.k8s.io/v1beta1\nkind: Kustomization\n\nresources:\n  - react.yml\n\nimages:\n  - name: byongho/gallery-react\n    newTag: 2196905e2ca3c8fd756293eb6565a393f433e91b # github-actions 워크플로우에서 생성하는 해쉬값으로, 초기값은 아무거나 집어 넣는다.\n</code></pre>\n<h3 id=\"312-springboot-예시\" style=\"position:relative;\"><a href=\"#312-springboot-%EC%98%88%EC%8B%9C\" aria-label=\"312 springboot 예시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.1.2. SpringBoot 예시</h3>\n<pre><code class=\"language-yml\"># gateway.yml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: gateway-dp\n\nspec:\n  selector:\n    matchLabels:\n      app: gateway\n  template:\n    metadata:\n      labels:\n        app: gateway\n    spec:\n      containers:\n        - image: chancehee/gallery-gateway\n          name: gateway\n          env:\n            - name: GALLERY_MEMBER_HOST\n              value: 'member-svc:8001'\n            - name: GALLERY_GALLERY_HOST\n              value: 'gallery-svc:8002'\n            - name: GALLERY_POST_HOST\n              value: 'post-svc:8003'\n          ports:\n            - containerPort: 8000\n\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: gateway-svc\nspec:\n  ports:\n    - port: 8000\n  selector:\n    app: gateway\n</code></pre>\n<pre><code class=\"language-yml\"># kustomization.yml\napiVersion: kustomize.config.k8s.io/v1beta1\nkind: Kustomization\n\nresources:\n  - gateway.yml\n\nimages:\n  - name: chancehee/gallery-gateway\n    newTag: 6919d288ad46de5a0129f0883fb9bf3ed2b8c4a5 # github-actions 워크플로우에서 생성하는 해쉬값으로, 초기값은 아무거나 집어 넣는다.\n</code></pre>\n<h2 id=\"32-argocd-연동\" style=\"position:relative;\"><a href=\"#32-argocd-%EC%97%B0%EB%8F%99\" aria-label=\"32 argocd 연동 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.2. argoCD 연동</h2>\n<p>이제 argoCD 웹 대쉬보드에 접속하여 앱을 생성한다. 위에서 만든 git 레포지토리의 타겟 브랜치와 폴더를 바라보도록 설정해준다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/c0d0e385a899023f7df4e866ebf63edf/44d59/argo-create-app-1.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABg0lEQVR42pWSzUsCURTFZ9PGjEQqMDHxK9Rc1CINXaqhRv11rYPEj8LJ6i9pEQQFtoiQsnSYGWfeqPM88Z4fmBlNF87izbvvx7lnruCN7sLhiyKZPUK5eoH7xwaemy10NALZghTdQEuS0Xhp4r0tQdgI7GDVG0Yik8dpqQRJVTEcDrn+qkmPJCu4e3jCa/MNgiuyh2V3EPF0HkVRhCwrIIYB1mpZY/BnpwPB6Q/D5g4gnimgUr+CqnZhUnPaaEWUUg78aDNgMMYd7qfzqF7XOdDo9aZN/ylJlhkwArsnhHgmj2KtBkVRoROCXr8/ymnBeFwL7jRiQFjjDkM4yBRwVq5CVlSYlGIwGFj6MbOlEQLB4YvB7tlGIltASRT5yBOH80B2Hpgmv1sUCQeuh0Zrk8ydoMIzZCMbXMzlbDFIV9PQ1XXQBe5HDreCWHK6kMod4/L2hmfIHhkG4esz/5Cd6S9RaDqBsLLph2BzIHVYwHmtNs7QBGWrM16JbxoDf3xn7nUdXzl2BgOZk5qFAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/c0d0e385a899023f7df4e866ebf63edf/c54d4/argo-create-app-1.webp 175w,\n/TIL/static/c0d0e385a899023f7df4e866ebf63edf/a3432/argo-create-app-1.webp 350w,\n/TIL/static/c0d0e385a899023f7df4e866ebf63edf/426ac/argo-create-app-1.webp 700w,\n/TIL/static/c0d0e385a899023f7df4e866ebf63edf/c139f/argo-create-app-1.webp 1050w,\n/TIL/static/c0d0e385a899023f7df4e866ebf63edf/7f403/argo-create-app-1.webp 1400w,\n/TIL/static/c0d0e385a899023f7df4e866ebf63edf/ba7d2/argo-create-app-1.webp 1553w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/c0d0e385a899023f7df4e866ebf63edf/4edbd/argo-create-app-1.png 175w,\n/TIL/static/c0d0e385a899023f7df4e866ebf63edf/13ae7/argo-create-app-1.png 350w,\n/TIL/static/c0d0e385a899023f7df4e866ebf63edf/8c557/argo-create-app-1.png 700w,\n/TIL/static/c0d0e385a899023f7df4e866ebf63edf/e996b/argo-create-app-1.png 1050w,\n/TIL/static/c0d0e385a899023f7df4e866ebf63edf/2cefc/argo-create-app-1.png 1400w,\n/TIL/static/c0d0e385a899023f7df4e866ebf63edf/44d59/argo-create-app-1.png 1553w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/c0d0e385a899023f7df4e866ebf63edf/8c557/argo-create-app-1.png\"\n            alt=\"argoCD 프로젝트 생성 1\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/077a5a0237b7c726ae4966643375edc2/dca52/argo-create-app-2.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABeklEQVR42p2Tz0sbQRzFBzxVLRopVkxFiVuJdUEPiujRKCYq/et6LjQ1KlkV/V+8eBC82UZL3J2N+2N29iMzxEJBZe2DB3N4vO/3fR8jpr8sUqossLa1S3P/kIvLK65vOnR7DwRvZDcIER8dl5HpKqu1Bt9a+3SlxCDPc4rCSnPoRTFiorrE4KTDSq1O0/O49wPCXo8oiomiiExr+vpnqfP873BrOFapMlieZaXWoHVyjJSSNE2tUBfYMssylFL2/RAbQ8flXdlheaPOwekJUoYkSYLKslc3+4f9wSadGHPmGf702Ub+0W4TyBClMlKl0FoXojmLwe/OLeKD4zJUdmwp31uH/On6JEqRpMUZJykq0/wyhqMVl+GpOVY3d/jpeXbD2ERWqnDTT7rO7R1ifM5ldGaetfpXe0M/CIji2Jqag+f9Fl+i0eh+ZD+QiJEph4HSBOvbexydn9lSngRvRRQniPflCmKoxPpWg2bb46Zzh/8fv8TwXoY8AqsnBLRMSQw1AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/077a5a0237b7c726ae4966643375edc2/c54d4/argo-create-app-2.webp 175w,\n/TIL/static/077a5a0237b7c726ae4966643375edc2/a3432/argo-create-app-2.webp 350w,\n/TIL/static/077a5a0237b7c726ae4966643375edc2/426ac/argo-create-app-2.webp 700w,\n/TIL/static/077a5a0237b7c726ae4966643375edc2/c139f/argo-create-app-2.webp 1050w,\n/TIL/static/077a5a0237b7c726ae4966643375edc2/7f403/argo-create-app-2.webp 1400w,\n/TIL/static/077a5a0237b7c726ae4966643375edc2/eb054/argo-create-app-2.webp 1550w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/077a5a0237b7c726ae4966643375edc2/4edbd/argo-create-app-2.png 175w,\n/TIL/static/077a5a0237b7c726ae4966643375edc2/13ae7/argo-create-app-2.png 350w,\n/TIL/static/077a5a0237b7c726ae4966643375edc2/8c557/argo-create-app-2.png 700w,\n/TIL/static/077a5a0237b7c726ae4966643375edc2/e996b/argo-create-app-2.png 1050w,\n/TIL/static/077a5a0237b7c726ae4966643375edc2/2cefc/argo-create-app-2.png 1400w,\n/TIL/static/077a5a0237b7c726ae4966643375edc2/dca52/argo-create-app-2.png 1550w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/077a5a0237b7c726ae4966643375edc2/8c557/argo-create-app-2.png\"\n            alt=\"argoCD 프로젝트 생성 2\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"33-github-actions-워크플로우-secret-등록\" style=\"position:relative;\"><a href=\"#33-github-actions-%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C%EC%9A%B0-secret-%EB%93%B1%EB%A1%9D\" aria-label=\"33 github actions 워크플로우 secret 등록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.3. Github Actions 워크플로우 Secret 등록</h2>\n<p>Secret는 Github Actions에서 사용되는 <strong>비밀 환경변수</strong>이다. key-value 형식으로 접근할 수 있으며, 외부에 공개되지 않기 때문에 application.properties와 같은 민감정보를 담을 수 있다.</p>\n<h3 id=\"331-docker-토큰-등록\" style=\"position:relative;\"><a href=\"#331-docker-%ED%86%A0%ED%81%B0-%EB%93%B1%EB%A1%9D\" aria-label=\"331 docker 토큰 등록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.3.1. Docker 토큰 등록</h3>\n<p>Github Actions에서 Dockerhub에 이미지를 푸시하기 위해서는 Dockerhub 토큰을 등록해줘야 한다.</p>\n<ol>\n<li>\n<p>Dockerhub에 로그인 한 후 계정 정보에 들어간다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/cd7c1/dockerhub-my-account.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAAB6ElEQVR42o2SzWoUQRRG+7EE30EN4ixGBEEIgi8gBDdZuRHEhaIQNcaFMFnEjSvBjSjEhcGfhRglDGISdDpVbXfXfx+5VTMS3GjDpau7qVPnu7eri1ua8USx9FixtKG48ESzPGkYrWtGDzSn7ypO3VGM1zSXHjZcfqRZXm85v/qKpWsfObdac3blByfPTDkx2qXytsc7S76GSAwOJ+9sT/CO4A3OdqQhAoHnb3tubBk2nr5mc/sT4+uaKyszXlz9zsv736iMsTRNg24anPOEEIgxktJASokQIyFEYkoMQ2J/Fni/51BdzA47X3ve7Zm89iFQWeto25ZfbZeB3ocMGoaBGAVYKq9DZEgxJ3HW0bUFBEMWEFbV94b6qGY2q+mNyUAxzMCFYYwZmGLKFt4n2vaQo9kHhjAlxbmh91TOOYzp6bpuHjWRUszx5B4zLBBTJOX4Ph9g+5/Y9gukKQxlBtKuyhiDUgql9Z/IYnfcMC4M5TmEXM44gom0neXg4BBrTTEUoNYapXSGSZ/KQEoPSxXz0tMypMVBjVbUdZ3nIN/zUCSu9LIY+nnsslkOkb4tANnOl9jSU5ERQ2HIc+VcKJt8QNYC/Vf5+V2Mjl9iXv0P4O+SVPIX7r/Z5va9TW4+22Fyaw29+5nfXVU9/4OHnZAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/c54d4/dockerhub-my-account.webp 175w,\n/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/a3432/dockerhub-my-account.webp 350w,\n/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/426ac/dockerhub-my-account.webp 700w,\n/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/c139f/dockerhub-my-account.webp 1050w,\n/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/7f403/dockerhub-my-account.webp 1400w,\n/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/0dd1a/dockerhub-my-account.webp 1547w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/4edbd/dockerhub-my-account.png 175w,\n/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/13ae7/dockerhub-my-account.png 350w,\n/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/8c557/dockerhub-my-account.png 700w,\n/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/e996b/dockerhub-my-account.png 1050w,\n/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/2cefc/dockerhub-my-account.png 1400w,\n/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/cd7c1/dockerhub-my-account.png 1547w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/aa7cb9bfa2f2258770312b42b830d0aa/8c557/dockerhub-my-account.png\"\n            alt=\"Dockerhub 계정 정보 진입\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</li>\n<li>\n<p>Write 권한을 포함하는 토큰을 생성한다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/d0ab7/dockerhub-token.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 56.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABwElEQVR42o2SXW7TQBRGvVgWwAJ4qcQTFQSJB0RVCar82Y4de8bx2GlQF8AeeIMUKTRV46Qe/+UgT0jUqALlSke2LPvcb66v5QcCEUjCUBCKCCklQoiTad9/iiUjyYdBiBMIhoMevj9mOp2SpilJkqCU+i/PhEJIzrsB3VFAqhTz21/M57f8/DFnsViwXq/JsuwZ7fPlcmkaCxEi5S6tFUUTkolChCGz2YxVlvH7bmm4e3gk1yVleUxRlFR1TZ7nXE9nJHHMdaqIJzGW7QxwR1/wfY9EpWhdsMlzdFHQNFvqZst2u6Npr82Wpmloq9AlsRrx/tM73nzs8Ll3idXtXeDYHTzPIUlS8lyzXmuqqqapG+oD9YGqqoy0bS4nA16+PuPFqzM6F2+xhkOHq6sBruuZeWw27Wy+mxm10roV/024r/1927w9ZiwdpspFTQSW67r0+31sxzUJi6JA67XpXpaVoSirwzGPhTlRFBEEEiFjQiGxRiMP27axbcesydMP/1V7odba/Nnh0CYIArOX1ngcmKX2PB+lThNW9ZZH/cBqdW+EbaAjYctpwl2y+yzjfNxl+u2Gm68zPN83sjAM+QNFgvqt0xuL+wAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/c54d4/dockerhub-token.webp 175w,\n/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/a3432/dockerhub-token.webp 350w,\n/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/426ac/dockerhub-token.webp 700w,\n/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/c139f/dockerhub-token.webp 1050w,\n/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/7f403/dockerhub-token.webp 1400w,\n/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/26719/dockerhub-token.webp 1532w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/4edbd/dockerhub-token.png 175w,\n/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/13ae7/dockerhub-token.png 350w,\n/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/8c557/dockerhub-token.png 700w,\n/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/e996b/dockerhub-token.png 1050w,\n/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/2cefc/dockerhub-token.png 1400w,\n/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/d0ab7/dockerhub-token.png 1532w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/164e6fe6c740e75dd06dbbca72ffbe8a/8c557/dockerhub-token.png\"\n            alt=\"Dockerhub 토큰 생성\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</li>\n<li>\n<p>Git 레포지토리 Secret 설정 화면에 들어간다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/12e1b/github-token-settings.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.85714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABjUlEQVR42m1STa/UMAzs/5e4AQf+BEckTpwQXOGCBEKc4L1Hd5vv2InTQXZfd7toLVlOE2fGM+mUCsHHjJAyXEgIti6WehZzQS6EkAh+fgv3+BrUCMSCyh3EHZXbJafWO5gZGuu6YgVQa4V3C9yyIHiP8+mMWgkijN4rRMRyjK3qvT0mJkYMEaUUO9RIueJhjpiXjLOvOC3BgGNMCCEi+IBlWeCdgwsF3MYVsPeOlLJNtTP5WPD7cYFzwQC81xpQagURWa9WqtUmH+M4IbMxHzdFOlpjs2KXNcawNFvGutXnPMakbLmUi4caKl8lOeegltyLI8yNhypDLyr7Hrq2qWRoN7oIKjG4NRCzfZsSnX4IxnrwMOdigOrlPcadwOlDOA/n4409Wz9uPVSJm18bU+Nme2r4/+C72Nae8OnHG3z49hK/5s/PwAOTSlHWnPNlyhATnv7O8DGBuKF1QZMtWTpUcUh/8P7LK7z7+gLfHz5eAVNOOM0/4X0Ec0NvHUR8+TX2172Xq6zms8jVw3//fFnwK2M1dQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/c54d4/github-token-settings.webp 175w,\n/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/a3432/github-token-settings.webp 350w,\n/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/426ac/github-token-settings.webp 700w,\n/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/c139f/github-token-settings.webp 1050w,\n/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/7f403/github-token-settings.webp 1400w,\n/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/92a1a/github-token-settings.webp 1607w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/4edbd/github-token-settings.png 175w,\n/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/13ae7/github-token-settings.png 350w,\n/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/8c557/github-token-settings.png 700w,\n/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/e996b/github-token-settings.png 1050w,\n/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/2cefc/github-token-settings.png 1400w,\n/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/12e1b/github-token-settings.png 1607w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/0f2cf3eea36bb9c83a4ef5414c847289/8c557/github-token-settings.png\"\n            alt=\"Github Secret 설정 화면\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</li>\n<li>\n<p>Dockerhub 토큰을 등록한다. Key 값은 원하는대로 지정하고 나중에 워크플로우에서 잘 참조하면 된다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/db7be/github-register-token.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.85714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABJElEQVR42qWSTU4DMQyF5/Ichi0L7sAW2LCqqEpbqjaZJHZ+PEkemmhadaQWDcLSUyTb+fLipDucNFbrDbRxOKoezkeQj3AcQBzAIcFHgXEeR22hjAOF1DT2jhpryhIOO4eOW4LaZks8rR4HZXDUDrq3MJbgyMNZgjUWSfJddcMwQERwHSFV2ABQqiD2ICLknLEkupRS2+DZI+ehJdl9wagXSFyhAk2l1ruqtV4DBaeTAjNfkiIRIoRSpDU3TeCbugbGGGcwtIYyNdVF15wBQ4hwzs2KdRnnNtB7D6V1G3qdHH1sH/H89oBSzs5/P6HMHMYIIoZIuhS++1e8b55Qi14EnL3y+G3GhxkdllLw3+h0r7Fef2K/34GZphkWlJr/5OwM/AGaFmBIJ7XHkQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/c54d4/github-register-token.webp 175w,\n/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/a3432/github-register-token.webp 350w,\n/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/426ac/github-register-token.webp 700w,\n/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/c139f/github-register-token.webp 1050w,\n/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/7f403/github-register-token.webp 1400w,\n/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/6926e/github-register-token.webp 1603w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/4edbd/github-register-token.png 175w,\n/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/13ae7/github-register-token.png 350w,\n/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/8c557/github-register-token.png 700w,\n/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/e996b/github-register-token.png 1050w,\n/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/2cefc/github-register-token.png 1400w,\n/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/db7be/github-register-token.png 1603w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/4391bc56d7896dbe07ff90f15a6cb86b/8c557/github-register-token.png\"\n            alt=\"Github Secret 등록\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n</li>\n</ol>\n<h3 id=\"332-환경변수-env-applicationyml\" style=\"position:relative;\"><a href=\"#332-%ED%99%98%EA%B2%BD%EB%B3%80%EC%88%98-env-applicationyml\" aria-label=\"332 환경변수 env applicationyml permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.3.2. 환경변수 (.env, application.yml)</h3>\n<p>.env나 application.yml 같은 파일 단위의 환경 변수는 <strong>그대로 등록해주면 된다</strong>. 이후 워크플로우 내에서 그대로 출력하여 파일로 생성할 것이다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/b6298a1568fc79a43ecc158638fe70f4/6dd26/github-register-application-properties.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.85714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABJklEQVR42qWS3U4bMRBG9/3fiFvUe66KWomLAopCUjC7nvHvjn2q3bQhEVQl6id9sjTjOZ6xPTz9dPx43PA6Cc9uRGM+OqRycK54TTy/TrhJ0FRWS8xISEwacV7Zb4UhxISXgIbTNa6Fo1fGSZi8IBoRL/jJU+ZGqfbOtRrDPM/UOnOqVBqSOiGDhoiqYq3xGQ25VFSUGAJmB7DKBhlvSPoVM6UDrfe/uvf+Biyl8vLiCCHQOSRy3OLdNWH8wlw2a2wpWrIf+hSYciaEeNZ274a1RO8ZsH+OeQ5MCRE9S55u+IzOgEt3zjlaa8eRb3d3XH2/xppdDlxGXl6xlnoEbv2eb7u79ZBLNdTf32Y2w8z4Xw2qgYf7B/a7PbXWNbh01i68xz/AX9GgYGzhgkObAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/b6298a1568fc79a43ecc158638fe70f4/c54d4/github-register-application-properties.webp 175w,\n/TIL/static/b6298a1568fc79a43ecc158638fe70f4/a3432/github-register-application-properties.webp 350w,\n/TIL/static/b6298a1568fc79a43ecc158638fe70f4/426ac/github-register-application-properties.webp 700w,\n/TIL/static/b6298a1568fc79a43ecc158638fe70f4/c139f/github-register-application-properties.webp 1050w,\n/TIL/static/b6298a1568fc79a43ecc158638fe70f4/7f403/github-register-application-properties.webp 1400w,\n/TIL/static/b6298a1568fc79a43ecc158638fe70f4/bd1ed/github-register-application-properties.webp 1597w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/b6298a1568fc79a43ecc158638fe70f4/4edbd/github-register-application-properties.png 175w,\n/TIL/static/b6298a1568fc79a43ecc158638fe70f4/13ae7/github-register-application-properties.png 350w,\n/TIL/static/b6298a1568fc79a43ecc158638fe70f4/8c557/github-register-application-properties.png 700w,\n/TIL/static/b6298a1568fc79a43ecc158638fe70f4/e996b/github-register-application-properties.png 1050w,\n/TIL/static/b6298a1568fc79a43ecc158638fe70f4/2cefc/github-register-application-properties.png 1400w,\n/TIL/static/b6298a1568fc79a43ecc158638fe70f4/6dd26/github-register-application-properties.png 1597w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/b6298a1568fc79a43ecc158638fe70f4/8c557/github-register-application-properties.png\"\n            alt=\"Github 파일 단위 Secret 등록\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h2 id=\"34-github-actions-워크플로우-작성\" style=\"position:relative;\"><a href=\"#34-github-actions-%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C%EC%9A%B0-%EC%9E%91%EC%84%B1\" aria-label=\"34 github actions 워크플로우 작성 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.4. Github Actions 워크플로우 작성</h2>\n<p>앞서 등록한 Secret을 참조하여 워크플로우의 상세내용은 각자 커스텀하면 된다. 전체적인 플로우는 <mark><strong>\"프로젝트 빌드 -> 도커 이미지 생성 -> 도커 이미지 푸시 -> argoCD 타겟 브랜치 yml파일 업데이트\"</strong></mark>를 따른다.</p>\n<p>한가지 주의할 점은 아래 워크 플로우의 <code>secrets.GITHUB_TOKEN</code>는 따로 등록해준 Secret이 아니다. 이는 워크플로우가 자체적으로 생성하는 토큰값으로, 워크플로우가 트리거된 레포지토리에 재접근할 수 있는 권한을 부여한다. 다만 이를 위해서는 'Settings > Actions > General'에서 다음과 같이 체크되어 있어야 한다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/04d89a98d99d13f51684909c23125a18/efeb1/GITHUB_TOKEN-permmisions.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 54.85714285714286%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABJ0AAASdAHeZh94AAABUklEQVR42p2S/WrbQBDE/f4Plr9KHyAQKDSNZd1Zui/d9+lXTjKOaWUIWRgQc2J2ZndPpVRqrbTWaOvKCpRaiCmScyKlHS4UjC9YX3BxJdf+5/918j4wXScWt1BK2UjrFv6cBR+D3HAeJFJKrlIyTVdSiht8SITUWB+0T8EHtDaknFhvL86nTegiJkY5cx4nlNJorbdmsbvO+ZbqH4cxRrRS5JzvpPWJYbgghEAKwTiOLMuyj+QBh5H7Q59hre1OppTpjbqDPoZ8c/OVOh2RwUe0XrDWE+Mutjd9QPv8Xtf2THCPYe3IeHlFijfm6RdGK5QyzCYwm4jUAWXDtv3uvrYngutN0Lh33n+/MHz8YBx+Ms+CWWliTJT6eV5fjpxLQ2mP0gFtAtOkmGeFMQZrLc65bcZHizkU9CGweL8deC6Z3BdTyjave5pnWz4i97PgW/UXMDtewdir0OAAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/04d89a98d99d13f51684909c23125a18/c54d4/GITHUB_TOKEN-permmisions.webp 175w,\n/TIL/static/04d89a98d99d13f51684909c23125a18/a3432/GITHUB_TOKEN-permmisions.webp 350w,\n/TIL/static/04d89a98d99d13f51684909c23125a18/426ac/GITHUB_TOKEN-permmisions.webp 700w,\n/TIL/static/04d89a98d99d13f51684909c23125a18/c139f/GITHUB_TOKEN-permmisions.webp 1050w,\n/TIL/static/04d89a98d99d13f51684909c23125a18/7f403/GITHUB_TOKEN-permmisions.webp 1400w,\n/TIL/static/04d89a98d99d13f51684909c23125a18/bd7e0/GITHUB_TOKEN-permmisions.webp 1593w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/04d89a98d99d13f51684909c23125a18/4edbd/GITHUB_TOKEN-permmisions.png 175w,\n/TIL/static/04d89a98d99d13f51684909c23125a18/13ae7/GITHUB_TOKEN-permmisions.png 350w,\n/TIL/static/04d89a98d99d13f51684909c23125a18/8c557/GITHUB_TOKEN-permmisions.png 700w,\n/TIL/static/04d89a98d99d13f51684909c23125a18/e996b/GITHUB_TOKEN-permmisions.png 1050w,\n/TIL/static/04d89a98d99d13f51684909c23125a18/2cefc/GITHUB_TOKEN-permmisions.png 1400w,\n/TIL/static/04d89a98d99d13f51684909c23125a18/efeb1/GITHUB_TOKEN-permmisions.png 1593w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/04d89a98d99d13f51684909c23125a18/8c557/GITHUB_TOKEN-permmisions.png\"\n            alt=\"Github Secret 등록\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<h3 id=\"341-react-예시\" style=\"position:relative;\"><a href=\"#341-react-%EC%98%88%EC%8B%9C\" aria-label=\"341 react 예시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.4.1. React 예시</h3>\n<pre><code class=\"language-yml\">name: CI\n\non:\n  push:\n    branches:\n      - front # 워크 플로우를 트리거할 브랜치\n\nenv:\n  IMAGE_NAME: gallery-react\n\njobs:\n  docker-build-and-deploy:\n    runs-on: ubuntu-latest\n\n    defaults:\n      run:\n        shell: bash\n        working-directory: ./frontend\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v3\n\n      - name: Setup Node # Node 환경 셋팅\n        uses: actions/setup-node@v3\n        with:\n          node-version: '18'\n\n      - name: Cache dependencies # 패키지 정보 캐싱 (선택 사항)\n        uses: actions/cache@v3\n        with:\n          path: ~/.npm\n          key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}\n          restore-keys: D\n            ${{ runner.os }}-node-\n\n      - run: npm ci # 패키지 설치\n      - run: npm run build # 프로젝트 빌드\n\n      - name: Login to Docker Hub # Dockerhub 로그인\n        uses: docker/login-action@v1\n        with:\n          username: ${{ secrets.FRONT_DOCKER_USERNAME }}\n          password: ${{ secrets.FRONT_DOCKER_TOKEN }}\n\n      - name: Build Docker image # Docker 이미지 빌드\n        run: docker build -t ${{ secrets.FRONT_DOCKER_USERNAME }}/${{ env.IMAGE_NAME }}:${{ github.sha }} .\n\n      - name: Push Docker image # Docker 이미지 푸시\n        run: docker push ${{ secrets.FRONT_DOCKER_USERNAME }}/${{ env.IMAGE_NAME }}:${{ github.sha }}\n\n  kustomize-update:\n    runs-on: ubuntu-latest\n    needs: docker-build-and-deploy # 전 단계 완료 후 진행 (순서 보장)\n\n    steps:\n      - name: Checkout repository\n        uses: actions/checkout@v2\n\n      - name: Switch to front-argo branch # 타겟 브랜치로 변경\n        run: |\n          git fetch\n          git checkout front-argo\n\n      - name: Set Kustomize # Kustomize 셋팅\n        uses: yokawasa/action-setup-kube-tools@v0.9.2\n        with:\n          kustomize: '3.7.0'\n\n      - name: Update kubernetes manifest # kustomization.yml 파일의 도커 이미지 버전 업데이트 후 커밋\n        run: |\n          cd config/deploy/react/\n          kustomize edit set image ${{ secrets.FRONT_DOCKER_USERNAME }}/${{ env.IMAGE_NAME }}:${{ github.sha }}\n          git config user.name \"GitHub Actions\"\n          git config user.email \"&#x3C;>\"\n          git add .\n          git commit -m 'k8s manifest for ${{ github.sha }}'\n\n      - name: Push changes # 커밋 내역 푸시\n        uses: ad-m/github-push-action@master\n        with:\n          github_token: ${{ secrets.GITHUB_TOKEN }} # 워크 플로우 자체 생성 토큰\n          branch: front-argo\n</code></pre>\n<h3 id=\"342-springboot-예시\" style=\"position:relative;\"><a href=\"#342-springboot-%EC%98%88%EC%8B%9C\" aria-label=\"342 springboot 예시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.4.2. SpringBoot 예시</h3>\n<pre><code class=\"language-yml\">name: CI\n\non:\n  push:\n    branches:\n      - back-gateway # 워크 플로우를 트리거할 브랜치\n\nenv:\n  IMAGE_NAME: gallery-gateway\n\njobs:\n  docker-build-and-deploy:\n    runs-on: ubuntu-latest\n\n    defaults:\n      run:\n        shell: bash\n        working-directory: ./backend/gateway\n\n    steps:\n      - name: Checkout code\n        uses: actions/checkout@v3\n\n      - name: Set up JDK 11 # JDK 환경 셋팅\n        uses: actions/setup-java@v2\n        with:\n          distribution: 'adopt'\n          java-version: '11'\n\n      - name: Retrieve application properties # Secret 정보 application.yml 파일로 추출\n        env:\n          APPLICATION_PROPERTIES: ${{ secrets.GATEWAY_APPLICATION_PROPERTIES }}\n        run: |\n          mkdir ./src/main/resources\n          touch ./src/main/resources/application.yml\n          echo \"${APPLICATION_PROPERTIES}\" > ./src/main/resources/application.yml\n\n      - name: Build Spring Boot application # 프로젝트 빌드\n        run: ./gradlew clean build -x test\n\n      - name: Login to Docker Hub # Dockerhub 로그인\n        uses: docker/login-action@v1\n        with:\n          username: ${{ secrets.BACK_DOCKER_USERNAME }}\n          password: ${{ secrets.BACK_DOCKER_TOKEN }}\n\n      - name: Build Docker image # Docker 이미지 빌드\n        run: docker build -t ${{ secrets.BACK_DOCKER_USERNAME }}/${{ env.IMAGE_NAME }}:${{ github.sha }} .\n\n      - name: Push Docker image # Docker 이미지 푸시\n        run: docker push ${{ secrets.BACK_DOCKER_USERNAME }}/${{ env.IMAGE_NAME }}:${{ github.sha }}\n\n  kustomize-update:\n    runs-on: ubuntu-latest\n    needs: docker-build-and-deploy # 전 단계 완료 후 진행 (순서 보장)\n\n    steps:\n      - name: Checkout repository\n        uses: actions/checkout@v2\n\n      - name: Switch to gateway-argo branch # 타겟 브랜치로 변경\n        run: |\n          git fetch\n          git checkout gateway-argo\n\n      - name: Set Kustomize # Kustomize 셋팅\n        uses: yokawasa/action-setup-kube-tools@v0.9.2\n        with:\n          kustomize: '3.7.0'\n\n      - name: Update kubernetes manifest # kustomization.yml 파일의 도커 이미지 버전 업데이트 후 커밋\n        run: |\n          cd config/deploy/gateway/\n          kustomize edit set image ${{ secrets.BACK_DOCKER_USERNAME }}/${{ env.IMAGE_NAME }}:${{ github.sha }}\n          git config user.name \"GitHub Actions\"\n          git config user.email \"&#x3C;>\"\n          git add .\n          git commit -m 'k8s manifest for ${{ github.sha }}'\n\n      - name: Push changes # 커밋 내역 푸시\n        uses: ad-m/github-push-action@master\n        with:\n          github_token: ${{ secrets.GITHUB_TOKEN }} # 워크 플로우 자체 생성 토큰\n          branch: gateway-argo\n</code></pre>\n<h1 id=\"4-실행화면\" style=\"position:relative;\"><a href=\"#4-%EC%8B%A4%ED%96%89%ED%99%94%EB%A9%B4\" aria-label=\"4 실행화면 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 실행화면</h1>\n<ol>\n<li><strong>github-actions 워크플로우 실행</strong><br>\ngit 레포지토리의 특정 브랜치에 소스코드가 푸시되면, 해당 브랜치에 연결된 워크플로우가 자동으로 실행된다.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/e35237d794aba0550a20f59ed7651090/229ad/argo-workflow.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 64%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABJ0AAASdAHeZh94AAABpklEQVR42n1S2Y4cIQzs///DKFJeIiW72ycYbHN1rXAPs5NJJpYswJiiKGr6WHZ8+/4DuyPM6w4fGKIZURJYEwIrdhdsv+/1euQEigJihY+CgyKWg/D+02EKUaz58MFy2x0oMLZ1w3GvE9Zbvfc6irZmSXa5pAJJ2S6aZr8iMkNVISJf422umnCep2WPMR/r1k6IKEQTamuYfu8z5mXBtu1Y1w37fsAdDiEEOOfAzLiO/jtaa/AUQCGi1IopxowY2dBrO1FqM4CsGeTpzl5LRW5AUkVKF2tPhNqqgQ7G09sxgwIZo944IqUComCAXYIoCq0nNCWwCGqtNnZWPWtt15MX2uHJg/lqGjc5Cvj19oGliz+E12xzvrmg1/ihpqlgEhYDe47+gxTkfnAcltvBZ7A4ALs+FILRfQwvjPnY4H3AfnSLqIGt5LAc3VIeomrPlUeGwwp/MUzZTD3SDN1Zs4JYEFhu5s9mbkdsXpxe2SHljBAZKZe78F/Z/ljn7oBcr095Bdil6J5sT1L8L/pLXwLWksxK3pPp1S1VSrkyF+TBfNTK5cdPbbb30wfYsH0AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/e35237d794aba0550a20f59ed7651090/c54d4/argo-workflow.webp 175w,\n/TIL/static/e35237d794aba0550a20f59ed7651090/a3432/argo-workflow.webp 350w,\n/TIL/static/e35237d794aba0550a20f59ed7651090/426ac/argo-workflow.webp 700w,\n/TIL/static/e35237d794aba0550a20f59ed7651090/c139f/argo-workflow.webp 1050w,\n/TIL/static/e35237d794aba0550a20f59ed7651090/08aa0/argo-workflow.webp 1356w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/e35237d794aba0550a20f59ed7651090/4edbd/argo-workflow.png 175w,\n/TIL/static/e35237d794aba0550a20f59ed7651090/13ae7/argo-workflow.png 350w,\n/TIL/static/e35237d794aba0550a20f59ed7651090/8c557/argo-workflow.png 700w,\n/TIL/static/e35237d794aba0550a20f59ed7651090/e996b/argo-workflow.png 1050w,\n/TIL/static/e35237d794aba0550a20f59ed7651090/229ad/argo-workflow.png 1356w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/e35237d794aba0550a20f59ed7651090/8c557/argo-workflow.png\"\n            alt=\"github-actions 워크플로우 실행\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></li>\n<li><strong>kustomization.yml 파일 업데이트</strong><br>\nargoCD 타겟 브랜치에 있는 kustomization 파일의 이미지 버전이 업데이트 된 것을 확인할 수 있다.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/bd954ab011a659d959ded646d76eaa7c/951a4/kustomization-update.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 58.285714285714285%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABJ0AAASdAHeZh94AAABrklEQVR42oWS644TMQxG5/1fDgkQqoBVWcp2u9OZ3O/JzIGk/EHbCktHnxNHjuN4Onx9Yr4KhDKDmCs+ZkIq+FTQNiC0RRmHC2nEutqOTyjrUdbxNhuuL45JSYVQdiRbhEJqhxwJPItUaOtZpR773ZfKjLhU9nZpzDf6ZT4zSSEopdBt3/eH3Ivfs0lbh3WeEBO5Vkpt5FIfU9+vfYi4ENn2nen4fOJ0euG6ytEL68Io3/3F32P0OI8kzsfRqnkR1NqYrLUorXHO0f2uOeeHT+rWWhtnemXGOlLKeO/H/hS9wyg5kmmthyqlyCnTamXftn9g30kxYYxFm15MLyKM9ajwMCeOV8ebjrxIx1l5LiZy1oGLSSyhvmONDZE2RLrpEhtLaOS2Ma1+w+QN6QM2tkFqOw2oQNkg3yHdofVP0esPvLkg5IXn4xe+Hz5w/PaR0/EzP58+ocUrJVly1P9BsbXKdJZvzHpllgu/lldmuyKTZg2KNUh8jeS93qEMjS0jnUZYRamFyZzDcPo4pFRo/bl1v2nbKaUNcq44FwkhEfvY9LHyEe8Txvrhtz89/A0wkqJWskyowAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/bd954ab011a659d959ded646d76eaa7c/c54d4/kustomization-update.webp 175w,\n/TIL/static/bd954ab011a659d959ded646d76eaa7c/a3432/kustomization-update.webp 350w,\n/TIL/static/bd954ab011a659d959ded646d76eaa7c/426ac/kustomization-update.webp 700w,\n/TIL/static/bd954ab011a659d959ded646d76eaa7c/c139f/kustomization-update.webp 1050w,\n/TIL/static/bd954ab011a659d959ded646d76eaa7c/d1c11/kustomization-update.webp 1355w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/bd954ab011a659d959ded646d76eaa7c/4edbd/kustomization-update.png 175w,\n/TIL/static/bd954ab011a659d959ded646d76eaa7c/13ae7/kustomization-update.png 350w,\n/TIL/static/bd954ab011a659d959ded646d76eaa7c/8c557/kustomization-update.png 700w,\n/TIL/static/bd954ab011a659d959ded646d76eaa7c/e996b/kustomization-update.png 1050w,\n/TIL/static/bd954ab011a659d959ded646d76eaa7c/951a4/kustomization-update.png 1355w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/bd954ab011a659d959ded646d76eaa7c/8c557/kustomization-update.png\"\n            alt=\"kustomization 파일 업데이트\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></li>\n<li><strong>Dockerhub 이미지 푸쉬</strong><br>\nkustomization 파일과 동일한 이미지 버전이 Dockerhub에 푸시되었다.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/e7d58a4d8e41477e31ade9869de2f661/b5a09/dockerhub-update.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 62.28571428571429%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAABJ0AAASdAHeZh94AAAB5ElEQVR42n2Ta27VMBCFs/81wEq6A34APxAtCNTeR/O4N4kTO37b+ZDdi4pQwdLRjDXHZ44nTnO+bAhpcc5hrEMbgzYWY23NS7TOk3ImxPQm/A0lbw5T5L5z3LeWh9byrXM8dI6nOXIUkUPBXBBqfrzhWUbO6wtalfhxjZzmQCNtYJSOcX3FdXXMW2BWf2B74Q1CM8ya1QR0yCiXWG1iNQllE822bQxDz2XomcYrYp5wzvPWMsZUXt89s4gZ7x3sO8u20887xmUaax3TLBBiYZUKrTXGWHLe3xC0HE8tx3PH4fjM0+FM2104nXva7oq1nialXA+/IBNjIsZY878RQsQYRzFhb7HsS6OSex9pNiWRciWlSAyenBP/WkV0EQvDZWCaprrf93yLOymlcmWPkqVbRJtQO5dCIRQUt79jOdi2HY+PT5xPJ7q+o+s6+r5nHMfKaaz9ipIf0NtngvvIngVqM7dZGpZlqW/0eh1ro1VcuQwtXd/XuQshKkdKRRlf44JgUSOTGNF6BEL9ytZZtN6qsLUWpVR1+OWn5tN3yXU2DGOpG0zhmYAPO42LCaF2pgW0fX0expoapZSE4KuT4uD9nePdnfvHjG+CUmcWlbEu10K5Yv0Vja4Ovfes61oF/7eK4C8uCp+QeZ9VAQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/e7d58a4d8e41477e31ade9869de2f661/c54d4/dockerhub-update.webp 175w,\n/TIL/static/e7d58a4d8e41477e31ade9869de2f661/a3432/dockerhub-update.webp 350w,\n/TIL/static/e7d58a4d8e41477e31ade9869de2f661/426ac/dockerhub-update.webp 700w,\n/TIL/static/e7d58a4d8e41477e31ade9869de2f661/c139f/dockerhub-update.webp 1050w,\n/TIL/static/e7d58a4d8e41477e31ade9869de2f661/90e3c/dockerhub-update.webp 1360w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/e7d58a4d8e41477e31ade9869de2f661/4edbd/dockerhub-update.png 175w,\n/TIL/static/e7d58a4d8e41477e31ade9869de2f661/13ae7/dockerhub-update.png 350w,\n/TIL/static/e7d58a4d8e41477e31ade9869de2f661/8c557/dockerhub-update.png 700w,\n/TIL/static/e7d58a4d8e41477e31ade9869de2f661/e996b/dockerhub-update.png 1050w,\n/TIL/static/e7d58a4d8e41477e31ade9869de2f661/b5a09/dockerhub-update.png 1360w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/e7d58a4d8e41477e31ade9869de2f661/8c557/dockerhub-update.png\"\n            alt=\"Dockerhub 이미지 푸쉬\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></li>\n<li><strong>argoCD 자동 실행</strong><br>\n3분 이내에 argoCD가 타겟 브랜치의 설정파일과 쿠버네티스를 동기화한다. 파드는 자동으로 교체되지만, 레플리카 셋은 기본으로 최근 10개까지를 기억한다.<br>\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/TIL/static/81357b521d9d9aeca2c328e74613e6c2/2af5b/argo-update.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 50.857142857142854%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAABJ0AAASdAHeZh94AAAB/klEQVR42l2RS2sUQRSF240gGIxGXEjUgDgRghKTqChEBNG/IBp1Iy4URlTUbPyVwZjM9LyS6cd0V1VXd9U8s5hPushI4oVDL6rqO+ee9u5uPmdh5SFvqz+odwKCWLDX6PC71mS33mJn32e31uKP32Znv4HODeVMp1Nm0x8O6WUFyli85UfPuFBZ592XbWRREGtNJwhJdUZmDLm1tERCqCQqL5hMJvw/J+HezccvOLt0h/fffx27jVA6JzMWbQf0h2NEboiEROqCLC/oj8aMj44YjMbY4djdmcm7VFnFW1jk9advZGZIJDKCNKMVCTqx5CCVDizNgFYsSLICOxhhhmN33ggSmk4pzTDFu7h0G+/cPC8/VIl1n9phTL2b0AhS2iW0J51BJxbucZBIdGHJ7cAB/RKaKvxE0UwU3pWVDc5cvs6rj19phIJuotyKodDOsUx68hvKzHUpdOHM9qKUutLsJ5JaLPEWHzzhfOUeW9Vt/DBxK6bacJjIU6BSZequUK5fmRsHbIeC1kyRwLu68ZS5yhpb1Z/0tHVrNY4Bs5W7admrdj1FUqNtH236HPTUP9OZvGtrm8wvr/Pm8zahMg7oUkWCg57kMJVkZkCscve4pzTaWLLCuvNmKE4Db9zfZO7WqksYnQDOoKXKxH43wS9/ilCowrgO2/FpWAn8C2/Kr1P062t8AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/TIL/static/81357b521d9d9aeca2c328e74613e6c2/c54d4/argo-update.webp 175w,\n/TIL/static/81357b521d9d9aeca2c328e74613e6c2/a3432/argo-update.webp 350w,\n/TIL/static/81357b521d9d9aeca2c328e74613e6c2/426ac/argo-update.webp 700w,\n/TIL/static/81357b521d9d9aeca2c328e74613e6c2/c139f/argo-update.webp 1050w,\n/TIL/static/81357b521d9d9aeca2c328e74613e6c2/7f403/argo-update.webp 1400w,\n/TIL/static/81357b521d9d9aeca2c328e74613e6c2/017f8/argo-update.webp 1697w\"\n              sizes=\"(max-width: 700px) 100vw, 700px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/TIL/static/81357b521d9d9aeca2c328e74613e6c2/4edbd/argo-update.png 175w,\n/TIL/static/81357b521d9d9aeca2c328e74613e6c2/13ae7/argo-update.png 350w,\n/TIL/static/81357b521d9d9aeca2c328e74613e6c2/8c557/argo-update.png 700w,\n/TIL/static/81357b521d9d9aeca2c328e74613e6c2/e996b/argo-update.png 1050w,\n/TIL/static/81357b521d9d9aeca2c328e74613e6c2/2cefc/argo-update.png 1400w,\n/TIL/static/81357b521d9d9aeca2c328e74613e6c2/2af5b/argo-update.png 1697w\"\n            sizes=\"(max-width: 700px) 100vw, 700px\"\n            type=\"image/png\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/TIL/static/81357b521d9d9aeca2c328e74613e6c2/8c557/argo-update.png\"\n            alt=\"argoCD 자동 실행\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></li>\n</ol>\n<h1 id=\"참고자료\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\" aria-label=\"참고자료 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고자료</h1>\n<ul>\n<li><a href=\"https://argo-cd.readthedocs.io/en/stable/getting_started/#getting-started\">argoCD 공식문서: Getting Started</a></li>\n<li><a href=\"https://malwareanalysis.tistory.com/402\">악분의 블로그: Kustomize 빠르게 시작하기</a></li>\n</ul>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#1-cicd-%EA%B5%AC%EC%83%81%EB%8F%84\">1. CI/CD 구상도</a></p>\n<ul>\n<li>\n<p><a href=\"#11-argocd-%EB%9E%80\">1.1. argoCD 란?</a></p>\n</li>\n<li>\n<p><a href=\"#12-kustomize-%EB%9E%80\">1.2. kustomize 란?</a></p>\n<ul>\n<li><a href=\"#121-%EB%8F%84%EC%BB%A4-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EC%97%85%EB%8D%B0%EC%9D%B4%ED%8A%B8\">1.2.1. 도커 이미지 업데이트</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2-argocd-%EA%B5%AC%EC%84%B1\">2. argoCD 구성</a></p>\n<ul>\n<li><a href=\"#21-argocd-%EC%84%A4%EC%B9%98\">2.1. argoCD 설치</a></li>\n<li><a href=\"#22-argocd-%EB%85%B8%EC%B6%9C\">2.2. argoCD 노출</a></li>\n<li><a href=\"#23-argocd-%EB%A1%9C%EA%B7%B8%EC%9D%B8\">2.3. argoCD 로그인</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#3-cicd-%EA%B5%AC%EC%B6%95\">3. CI/CD 구축</a></p>\n<ul>\n<li>\n<p><a href=\"#31-argocd-%ED%83%80%EA%B2%9F-%EB%B8%8C%EB%9E%9C%EC%B9%98-%EC%83%9D%EC%84%B1\">3.1. argoCD 타겟 브랜치 생성</a></p>\n<ul>\n<li><a href=\"#311-react-%EC%98%88%EC%8B%9C\">3.1.1. React 예시</a></li>\n<li><a href=\"#312-springboot-%EC%98%88%EC%8B%9C\">3.1.2. SpringBoot 예시</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#32-argocd-%EC%97%B0%EB%8F%99\">3.2. argoCD 연동</a></p>\n</li>\n<li>\n<p><a href=\"#33-github-actions-%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C%EC%9A%B0-secret-%EB%93%B1%EB%A1%9D\">3.3. Github Actions 워크플로우 Secret 등록</a></p>\n<ul>\n<li><a href=\"#331-docker-%ED%86%A0%ED%81%B0-%EB%93%B1%EB%A1%9D\">3.3.1. Docker 토큰 등록</a></li>\n<li><a href=\"#332-%ED%99%98%EA%B2%BD%EB%B3%80%EC%88%98-env-applicationyml\">3.3.2. 환경변수 (.env, application.yml)</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#34-github-actions-%EC%9B%8C%ED%81%AC%ED%94%8C%EB%A1%9C%EC%9A%B0-%EC%9E%91%EC%84%B1\">3.4. Github Actions 워크플로우 작성</a></p>\n<ul>\n<li><a href=\"#341-react-%EC%98%88%EC%8B%9C\">3.4.1. React 예시</a></li>\n<li><a href=\"#342-springboot-%EC%98%88%EC%8B%9C\">3.4.2. SpringBoot 예시</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p><a href=\"#4-%EC%8B%A4%ED%96%89%ED%99%94%EB%A9%B4\">4. 실행화면</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\">참고자료</a></p>\n</li>\n</ul>","frontmatter":{"title":"github-actions와 argoCD로 쿠버네티스 GitOps 관리하기","createdAt":"2024-03-04","updatedAt":"2024-03-04","tags":["kubernetes","k3s","github-actions","argoCD","DevOps","GitOps","CI/CD"],"description":"github-actions로 프로젝트를 자동 빌드(CI)하고, 이어서 argoCD로 쿠버네티스 클러스터에 자동 배포(CD)하자","reference":null}},"allMarkdownRemark":{"nodes":[{"id":"d1bef05b-59a5-5ce7-bad3-58de985ee6e7","excerpt":"시작하기 전에... Django와 Vue를 이용해서 만든 Boogie 프로젝트의 기초적인 배포 과정을 정리한 문서이다. Boogie 웹사이트 링크 .pem 키를 이용해 원격 EC2에 SSH(Secure Shell…","parent":{"id":"2ea277ab-7b29-5f4b-afa3-0bece450e0fd","name":"django_and_vue_with_ssh_actions","relativePath":"DevOps/CI&CD/django_and_vue_with_ssh_actions.md"},"frontmatter":{"title":"Django와 Vue 프로젝트 Github SSH Action으로 자동 배포하기","createdAt":"2023-05-20","updatedAt":"2023-07-21"},"fields":{"slug":"/posts/DevOps/CI&CD/django_and_vue_with_ssh_actions/"}},{"id":"038327b7-454e-5f16-bf59-11f5e4eb625f","excerpt":"1. CI/CD 구상도  개인적으로 CI/CD를 구축하는 데 있어 가장 큰 어려움은, 기술적인 난이도보다 전체 아키텍쳐 구성의 이해에 있는 것 같다. 위 아키텍쳐의 실제 동작 순서는 아래와 같다. Github…","parent":{"id":"1893a81b-6264-569c-b9d8-6e0a6bfce944","name":"github_actions_argoCD","relativePath":"DevOps/CI&CD/github_actions_argoCD.md"},"frontmatter":{"title":"github-actions와 argoCD로 쿠버네티스 GitOps 관리하기","createdAt":"2024-03-04","updatedAt":"2024-03-04"},"fields":{"slug":"/posts/DevOps/CI&CD/github_actions_argoCD/"}}]}},"pageContext":{"pagePath":"/posts/DevOps/CI&CD/github_actions_argoCD/","siblingPostsPathRegex":"/^(?!.*README).*DevOps\\/CI&CD\\/.*$/","relativeDirectory":"CI&CD","id":"038327b7-454e-5f16-bf59-11f5e4eb625f","parent":{"id":"1893a81b-6264-569c-b9d8-6e0a6bfce944","name":"github_actions_argoCD","relativePath":"DevOps/CI&CD/github_actions_argoCD.md"},"fields":{"slug":"/posts/DevOps/CI&CD/github_actions_argoCD/"}}},"staticQueryHashes":["24302420","4059933791"],"slicesMap":{}}