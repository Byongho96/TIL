{"componentChunkName":"component---src-templates-post-index-tsx","path":"/posts/DevOps/Kubernetes/k3s_1_intro/","result":{"data":{"markdownRemark":{"id":"353ab996-d3e6-5556-8c06-077b7b2f6370","html":"<h1 id=\"1-프로젝트-개요\" style=\"position:relative;\"><a href=\"#1-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EA%B0%9C%EC%9A%94\" aria-label=\"1 프로젝트 개요 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 프로젝트 개요</h1>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/TIL/static/f15a3f6bc1f8ad128ddea7349aa96980/c1b63/the-gallery.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 52.57142857142857%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAACFklEQVR42q2TTWgTQRTHk7QIFlGzkczbGD9ARCiIUigKSksPHosHCXhtsdnuzuw20cQ0B1lR0EoVCoog+Hn1KgUpsTmoWHoQqeLBgwfbJu7Mppo0lrTWPtnNpqRgPYgP/gy89+Y378F/fD430O9DT/8h/HU1YJtB0b95bWNjIGLws0Ct+zKzTrgpEwONy5Jub48Ml0P1nDfA3zYBVorJRmVGPr/8ERJLSJg1Jpvzbb4Ytrh1nXcTKi4Tamdh0Dqz/mA3tro9Dtw5Y09b6kBjcQr0b1+A8teQqKKcQgRWmozQuZBTJ4PFMGhCIaroAa2wjyjF/aAWOttjH7Z48FZP9a2A2WuEillgdh6GfiDReA0u/ELCFsZdILX7iC6eEGYz0PiInKzdldP4CPTS7TDj14DxS4SJNNF4f31CfWGVUD4HTEyAUUFCxXJYtWpyahWjmZWubX2F9uAAvyPFeSKk8Oe7lK/XJaWYDSr88c4B696O/mKPpH2/FVRLcQ9YzsFQtRxJVCfcdY3Fn5BcQTDK89K52Sgibk2O4+GxGSSORt9h+MpbPDgyhdGrr/DAjWk81HWzEj/9cGmPCySq6AUq3shMPACNfwbK3xNqfYrootepK89wdzaHp4Yn8djF/NrxzAs8ksrj0XQOOzJ5POlodBo7zZe417fRd3+ywr8YHRuGbfotphlo+A4R/SZiYF1mk5ry6HnzNyyhISQVAq22AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/TIL/static/f15a3f6bc1f8ad128ddea7349aa96980/c54d4/the-gallery.webp 175w,\n/TIL/static/f15a3f6bc1f8ad128ddea7349aa96980/a3432/the-gallery.webp 350w,\n/TIL/static/f15a3f6bc1f8ad128ddea7349aa96980/426ac/the-gallery.webp 700w,\n/TIL/static/f15a3f6bc1f8ad128ddea7349aa96980/c139f/the-gallery.webp 1050w,\n/TIL/static/f15a3f6bc1f8ad128ddea7349aa96980/92f8c/the-gallery.webp 1200w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/webp\">\n          <source srcset=\"/TIL/static/f15a3f6bc1f8ad128ddea7349aa96980/4edbd/the-gallery.png 175w,\n/TIL/static/f15a3f6bc1f8ad128ddea7349aa96980/13ae7/the-gallery.png 350w,\n/TIL/static/f15a3f6bc1f8ad128ddea7349aa96980/8c557/the-gallery.png 700w,\n/TIL/static/f15a3f6bc1f8ad128ddea7349aa96980/e996b/the-gallery.png 1050w,\n/TIL/static/f15a3f6bc1f8ad128ddea7349aa96980/c1b63/the-gallery.png 1200w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/TIL/static/f15a3f6bc1f8ad128ddea7349aa96980/8c557/the-gallery.png\" alt=\"더 갤러리 로고\" title=\"\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span>\n<p>백엔드 개발자 친구와 함께 <strong>쿠버네티스를 연습하기 위한 토이프로젝트</strong>를 만들었다. 명색이 쿠버네티스 프로젝트인데 MSA를 안할 수 없었다. 백엔드가 MSA로 바쁜데, 프론트가 가만히 있을 수 없어 Three.js를 적용했다. 당초 한 달 만에 끝내려던 프로젝트가 반년 가까이 이어졌다. 오늘(2024.01.21) 기준으로 접속은 가능한데 아직 자잘한 에러가 많아서 수정 중에 있다.</p>\n<h1 id=\"2-아키텍쳐-구상도\" style=\"position:relative;\"><a href=\"#2-%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-%EA%B5%AC%EC%83%81%EB%8F%84\" aria-label=\"2 아키텍쳐 구상도 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. 아키텍쳐 구상도</h1>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/TIL/static/1dae5d030ab87c47f4405a5110ee3626/2bef9/architecture.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70.28571428571428%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAACiklEQVR42nWUW2/bRhSE9f//QIG85LEvQZGijZECdp3ArW0YiWPFkR1ZlHiVRHJ5EcnlRSR3v0BiZDcOusABeQbc4cwezI4AzbPVNFvG4zFBVvO3o+iBbeYTrwPq7BWq879/+dNWPTqAqs7oYgddZvTZmvVsTBZ6LLwl1AnJaoI9H1O4R+jcApmADEGKoUoBWjFCD4S6KenvXqLufwHvgm51hVpewOoc7fyDds9pFu+pjHNw/wX3HdinT2W9h65mpLUeNHYtWL+jsxP6XpB6Eyzzmqb10WxAR0jpUG99+sKg9a9AO+h2AcqB+DNsSx4t05awvAYkEKGlhYwfuI1sXgsDEFRyRU9OePYnq19f7E4brWLY/TD+MhAKIXiYGVR5Qj49QeYmIjb4KDwCMaNWKYtqpyTg6/qUW+cdYTinyG02zZrFekJd25DcwVYyKoqcUETQVij3AnS4t3kd2ISxSZJN2JR3ZLHFvX+Mm16RpQ6F9NBKkJZLml48KXyyXIF3CVrsz6vvfFQXYoaXmPE5m8QkLu4pGgPPneO5Jl3n0zRLVO9DPBkIH4fyA6GgKAO0iuhVwLbzyBKLa/cP7vwTbMvEtObE0mUePFA3HiQT9HOFekdIiKxDXhyFbIpw3++slYVDURs0rc0mdUgSe69Ma4Eigvj2fyyT0HYJH2YR9XY3waHKfMmV9Rs362P8yCatPLJWYIspbbuE9H4Yyg+E9hlIA0qDvllAtRj6YgbtkjyfUidTqOwBlwZ1OkXJOfgfDgoPKVRDhIoAlQd4xi1lMN9juo7RD58ojo/46F2Sb0woBLoIhvgdnvvo/Sfhh5em7TkbzxFp9ojrmxt48xdv+6942+g7rp9fD+ob62QltT/kjygAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/TIL/static/1dae5d030ab87c47f4405a5110ee3626/c54d4/architecture.webp 175w,\n/TIL/static/1dae5d030ab87c47f4405a5110ee3626/a3432/architecture.webp 350w,\n/TIL/static/1dae5d030ab87c47f4405a5110ee3626/426ac/architecture.webp 700w,\n/TIL/static/1dae5d030ab87c47f4405a5110ee3626/a9a89/architecture.webp 1024w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/webp\">\n          <source srcset=\"/TIL/static/1dae5d030ab87c47f4405a5110ee3626/4edbd/architecture.png 175w,\n/TIL/static/1dae5d030ab87c47f4405a5110ee3626/13ae7/architecture.png 350w,\n/TIL/static/1dae5d030ab87c47f4405a5110ee3626/8c557/architecture.png 700w,\n/TIL/static/1dae5d030ab87c47f4405a5110ee3626/2bef9/architecture.png 1024w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/TIL/static/1dae5d030ab87c47f4405a5110ee3626/8c557/architecture.png\" alt=\"프로젝트 아키텍쳐 구상도\" title=\"\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span>\n<p><mark>AWS Lightsail 인스턴스에 k3s를 직접 설치해서 클러스터를 구성했다</mark>. 이러한 결정에는 금전적인 요인이 크게 작용했다. EKS의 시간당 사용료가 0.1달러에서 시작했는데, 한 달을 서비스하면 최소 72달러(약 97000원)이다. 안그래도 요즘 유튜브 프리미엄도 해지하는 마당에 터무니없는 금액이었다. 그래서 우리가 생각해낸 것이 Lightsail과 k3s이다.</p>\n<h2 id=\"21-lightsail-이란\" style=\"position:relative;\"><a href=\"#21-lightsail-%EC%9D%B4%EB%9E%80\" aria-label=\"21 lightsail 이란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.1. Lightsail 이란?</h2>\n<p>지금까지는 항상 EC2를 사용했는데 이번 기회로 Lightsail을 접할 수 있었다. EC2가 사용량에 따라 과금되는 방식이라면, Lightsail은 구독형 서비스처럼 월별 요금으로 플랜을 선택한다. 단순 계산으로 CPU 2 코어, 메모리 4GB를 24시간 30일 구동했을 때, <mark>EC2는 30달러 / Ligthsail은 20달러이다.</mark></p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/TIL/static/17bdc655c9bc1bd0841debdf0de8ba70/76823/ec2-pricing.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 43.99999999999999%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABJ0AAASdAHeZh94AAABiElEQVR42mVR7Y7bIBD087a/gvokfau+Q08X27nkEhsw32DAU+0mPVUq0or9YGfG4+Hz845xmjBfPjCOI6Zpxvk8YhwnTPOMlBJqrdj3/SsqRa1orf03G5TWUErBWsfhvId1lFs455BzRikFZd/5pqUQI8+11jwn0BgjzwdjDC9SkxohBFb1l5HylPPzTgm5FHjvn8TWwr/eEzDF8P5+xv3x4GLbNvx+e8NjWRg8pgStN1akt43zkjOkVF+KrtcbWxZfoAOxEAOdzI8le3McB/rLI8rJBgLuvTMg7xwHqyXLjLGMMdDn+hC5IEapNHo/uKZlAqfjnGfwJ6BmG+gEH6D0xv4/Aa2EcxLAjpIt1vUDrUUcKOgtotVAVHB2Ra2Be1LekJLhvvcKSt1gzYIDDYN7/IS+fMNhfqBIATWf0DaBwwj0TaBpAVgBexOoSqBrATmfkNYT98NdQF8EzPU7sP+ivyyZhdhKNljXK3qPwJHQW0CrntyF2RbU6v9RuHHfO1J4hzELmYQ/2Gytp2QQrTEAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/TIL/static/17bdc655c9bc1bd0841debdf0de8ba70/c54d4/ec2-pricing.webp 175w,\n/TIL/static/17bdc655c9bc1bd0841debdf0de8ba70/a3432/ec2-pricing.webp 350w,\n/TIL/static/17bdc655c9bc1bd0841debdf0de8ba70/426ac/ec2-pricing.webp 700w,\n/TIL/static/17bdc655c9bc1bd0841debdf0de8ba70/6a022/ec2-pricing.webp 1038w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/webp\">\n          <source srcset=\"/TIL/static/17bdc655c9bc1bd0841debdf0de8ba70/4edbd/ec2-pricing.png 175w,\n/TIL/static/17bdc655c9bc1bd0841debdf0de8ba70/13ae7/ec2-pricing.png 350w,\n/TIL/static/17bdc655c9bc1bd0841debdf0de8ba70/8c557/ec2-pricing.png 700w,\n/TIL/static/17bdc655c9bc1bd0841debdf0de8ba70/76823/ec2-pricing.png 1038w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/TIL/static/17bdc655c9bc1bd0841debdf0de8ba70/8c557/ec2-pricing.png\" alt=\"AWS EC2 가격표\" title=\"\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/TIL/static/f7a804e1ad883c19890c37321c7505c9/0d0e4/lightsail-pricing.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 32%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABJ0AAASdAHeZh94AAABLUlEQVR42n2QO2/kMAyE/f/rtEl+SdpUV1wRIOvsJvBrDb/ktSxLlOQAX2Dtpb2C4ABDzgyZxW3iW1c4c6NWgt48+x6J8be+iVGIMfzD8b+VBTG4dcLLhhOPc44QAiIO53aCnHG3R2R5JvgGa++cDwFrLd57RITN2rSXHSJVXbPZQ8DS9z0hRpblRteN7PJK332hpg92/5e2HVjXNQk1dY14j14012uTTLKDOJyC92noEP1NKOKJ/gMnknCQd5yTNBdSwvs19707zoah53Q6odRM13Wcz2fMulKWBUXRoOcXLpectvnDbXolz78Yx4Gh78lPOfM8U1UVl8tnSp5prSmKgqNP40hZVhhjaNsrbTtiljfqzweG6xOrrpLJrBRKKcqiZFmW9KbjbcZs/ADgjsd2Ns74QwAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/TIL/static/f7a804e1ad883c19890c37321c7505c9/c54d4/lightsail-pricing.webp 175w,\n/TIL/static/f7a804e1ad883c19890c37321c7505c9/a3432/lightsail-pricing.webp 350w,\n/TIL/static/f7a804e1ad883c19890c37321c7505c9/426ac/lightsail-pricing.webp 700w,\n/TIL/static/f7a804e1ad883c19890c37321c7505c9/c139f/lightsail-pricing.webp 1050w,\n/TIL/static/f7a804e1ad883c19890c37321c7505c9/fc6cc/lightsail-pricing.webp 1230w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/webp\">\n          <source srcset=\"/TIL/static/f7a804e1ad883c19890c37321c7505c9/4edbd/lightsail-pricing.png 175w,\n/TIL/static/f7a804e1ad883c19890c37321c7505c9/13ae7/lightsail-pricing.png 350w,\n/TIL/static/f7a804e1ad883c19890c37321c7505c9/8c557/lightsail-pricing.png 700w,\n/TIL/static/f7a804e1ad883c19890c37321c7505c9/e996b/lightsail-pricing.png 1050w,\n/TIL/static/f7a804e1ad883c19890c37321c7505c9/0d0e4/lightsail-pricing.png 1230w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/TIL/static/f7a804e1ad883c19890c37321c7505c9/8c557/lightsail-pricing.png\" alt=\"AWS 라이트세일 가격표\" title=\"\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span>\n<p>그러나 완벽한 제품이란 없는 것 같다. Ligthsail은 CPU 사용에 유난히도 엄격다. CPU 사용량을 특정 퍼센티지 기준으로 Burst Zone과 Sustainable Zone을 나누는데, CPU 사용량에 높아져 Burst zone에 들어서게 되면 나에게 할당된 CPU 크레딧을 줄어들기 시작한다. CPU 크레딧이 감소해 0에 도달하면 인스턴스가 멈춘다😱. CPU 크레딧을 다시 채우기 위해서는 CPU 사용을 Sustainable Zone에 두어야 한다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/TIL/static/3495c5d28e123e00a981a2df66169464/4b446/lightsail-cpu-burst.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 63.42857142857142%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAABJ0AAASdAHeZh94AAABvklEQVR42p1S246bMBTk//+n732pVLW72iSkuwTIpU1zww6+AMbGdqayw1ZZrVqlfRjNMLbH5/iQEErBhACXEjUXEUEzISGaBtoY9Frfha7rkDDGMJgeF6cjvNW42KsODGd+861+5/kB3jkkIVU3NZwKYBi6KwfYUQe2ozfceJFHz/cczg5I6rqGCoG9iLCKv9P3eF7La2CnFHTH4YKhBWy4aUSs6ob/5nktxgoZgxIVnNzByT1sS8eb/y3wYiQOvAtvqKAlgROvgeS/AkOFddtfp6waNrYs/9By+Gb3tRyn3NbXhX6cYjwcJljfMB+nWr9Ze/W85rAhkLEauhPwfA/fnuFNB28aeNPGioN2uoELk4xavuW4r8FlaOGsRaI6hdOpxGr2AZv8I3b7OWhVgFY5KClBaQl63oBsvoB8fwClK1BSgJJl3EN2KcgpBzsvsa4YEqMNTrsVBN3guH3BYbuIP+1hs0AvCZrzDmS/hm0Iqh8vaPkJih9x/FnGdul2AXnexzdszYAkyzLkRYlyuY5Y5EGvIufFEkW5xGSaYjKbI53Pkc2ekKUTzJ8eUXxLMZtO8enzVzynM+TTR/wC0jHitIm4qQAAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/TIL/static/3495c5d28e123e00a981a2df66169464/c54d4/lightsail-cpu-burst.webp 175w,\n/TIL/static/3495c5d28e123e00a981a2df66169464/a3432/lightsail-cpu-burst.webp 350w,\n/TIL/static/3495c5d28e123e00a981a2df66169464/426ac/lightsail-cpu-burst.webp 700w,\n/TIL/static/3495c5d28e123e00a981a2df66169464/d7666/lightsail-cpu-burst.webp 877w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/webp\">\n          <source srcset=\"/TIL/static/3495c5d28e123e00a981a2df66169464/4edbd/lightsail-cpu-burst.png 175w,\n/TIL/static/3495c5d28e123e00a981a2df66169464/13ae7/lightsail-cpu-burst.png 350w,\n/TIL/static/3495c5d28e123e00a981a2df66169464/8c557/lightsail-cpu-burst.png 700w,\n/TIL/static/3495c5d28e123e00a981a2df66169464/4b446/lightsail-cpu-burst.png 877w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/TIL/static/3495c5d28e123e00a981a2df66169464/8c557/lightsail-cpu-burst.png\" alt=\"라이트세일 CPU 사용량 그래프\" title=\"\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span>\n<p>따라서 Lightsail은 CPU 사용량이 많은 서비스에는 적합하지 않다. 우리도 한 번 CPU 크레딧을 모두 소모하여 인스턴스가 작동을 멈췄다. 다시 재가동했을 때 Sustainable Zone에 머물러 있어서, 일단 한 번 더 믿어보기로 했다. 또 다시 인스턴스가 멈추면 EC2로 넘어갈 예정이다.</p>\n<h2 id=\"22-k3s-이란\" style=\"position:relative;\"><a href=\"#22-k3s-%EC%9D%B4%EB%9E%80\" aria-label=\"22 k3s 이란 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2.2. k3s 이란?</h2>\n<p>k3s는 쉽게 말해 <strong>쿠버네티스(k8s)의 경량화 버전</strong>이다. 기존 쿠버네티스보다 메모리를 절반 밖에 사용하지 않으며, 가볍고 ARM 아키텍처를 지원하는 덕에 IoT 디바이스에도 적합하다고 한다.</p>\n<table>\n<thead>\n<tr>\n<th></th>\n<th>CPU 권장</th>\n<th>RAM 권장</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>k3s</td>\n<td>2 코어</td>\n<td>1GB</td>\n</tr>\n<tr>\n<td>k8s</td>\n<td>2 코어</td>\n<td>2GB</td>\n</tr>\n</tbody>\n</table>\n<p>기본적인 아키텍쳐는 쿠버네티스와 동일하다. 쿠버네티스와 똑같이 서버 노드(마스터 노드)와 에이전트 노드(워커 노드)로 분산 클러스트를 구성할 수 있다. 하지만 우리는 인스턴스가 하나 밖에 없으므로 마스터 노드 하나로 단일 클러스터를 구성했다. 그 외 쿠버네티스의 일부 기능을 포함하지 않는다고는 하는데, 입문하는 수준에서는 아무런 차이를 경험하지 못했다.</p>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/TIL/static/99896aa68b52fd8e7469e4d18226377f/2bef9/k3s-architecture.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 57.714285714285715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAAsTAAALEwEAmpwYAAACvklEQVR42lWT21PbRhjF9ff3qX3IQ+hDKAxMQjuZMi0NGALElmUbbISNuQTii2xLsu53rS/Yv46VtjN9OHN25+w3337n7EqxWSe1rkitxn9Ipg38SbXgf7V4Wif5R8/sBpFZwx9X/1c781pLaebfsE46rOIO67QLaRfhNvHGMjO/VWhkd9iaTOZcQ3rHa9xmcxF3JLMI1eLMMlSJpw2kTddFoDLzGiTGZxL9M/bgktHTGfbgC6ndIHeui72jlZn5TTLnCntYZtq/JDRqzIMbUvuKyKgjCe8GxCPr6Arn4S3By3YxUmw1Se1WAeGpfFX/Yvz1nMRqskq7rJMuq+SOdXoP+QO52yLQFSRhnbJ0jll5JULtN4R5yCo4ZW6fsHRLLOxjCM8ZPZcIJheEvT2yySFL5wRhfmJpHxfIjGNCvYokjEPS4QfCl21G7XeY3R2Cl3cY97vko/fFOhnuoz+fEA6PmLR/Jvy2SzrYw3rcZTbeJ3jeJux/IDIUpNypkhol5n4Lp/+JxLxg5jbIzBLkbWZRh1mgon+7wJ8opG6LtdiMeQtCBdEl91Via+NhDcl73mXa+Ym1/Tu9xo+Yd1vg/4He+oGot0Oo13iNbtGezr4n76kEozOC5y3cxzfE2kfi6XURXuFhbMrMvTqZXf2e9FTG7x2gd7ZwXg7InWbxCszeZVGwCNvERgXr8ReMzhahdkTuqWSblM0a0iJug3iAvAtZtzA21Q5w7t+Qar8S6nKh2SMZ4bdYRrdEk3Pi/g7e01vSyVHxAdZZh8isryVr8AV/IuOOq0T6OVF/D+GUCXo75HaFeLBXpGsNKzgjhVD7k2T8kcw8JRq+J7cvCPv7uFqF2L5GckeysIdlYfXLIjJkQaiIZKqIVbDhqiBShD+uiLl/I2KzLjJLFktfEbmtFJxZVfEaKMIby7NVfBv+DQufXhzQ8GlzAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/TIL/static/99896aa68b52fd8e7469e4d18226377f/c54d4/k3s-architecture.webp 175w,\n/TIL/static/99896aa68b52fd8e7469e4d18226377f/a3432/k3s-architecture.webp 350w,\n/TIL/static/99896aa68b52fd8e7469e4d18226377f/426ac/k3s-architecture.webp 700w,\n/TIL/static/99896aa68b52fd8e7469e4d18226377f/a9a89/k3s-architecture.webp 1024w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/webp\">\n          <source srcset=\"/TIL/static/99896aa68b52fd8e7469e4d18226377f/4edbd/k3s-architecture.png 175w,\n/TIL/static/99896aa68b52fd8e7469e4d18226377f/13ae7/k3s-architecture.png 350w,\n/TIL/static/99896aa68b52fd8e7469e4d18226377f/8c557/k3s-architecture.png 700w,\n/TIL/static/99896aa68b52fd8e7469e4d18226377f/2bef9/k3s-architecture.png 1024w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/TIL/static/99896aa68b52fd8e7469e4d18226377f/8c557/k3s-architecture.png\" alt=\"k3s 아키텍쳐\" title=\"\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span>\n<p>주의할 것은 경량화 버전이지만, <strong>오히려 일부 편의기능은 기본 탑재되어 있다.</strong> 대표적으로 Helm이나 Ingress가 기본 탑재되어 있다. 이걸 몰랐던 우리는 엄청난 삽질과 좌절의 시간을 거쳐야만 했다. k3s를 사용하면 쿠버네티스가 아닌 <a href=\"https://docs.k3s.io/\">k3s 공식문서</a>를 보도록 하자...</p>\n<h1 id=\"3-사전-준비\" style=\"position:relative;\"><a href=\"#3-%EC%82%AC%EC%A0%84-%EC%A4%80%EB%B9%84\" aria-label=\"3 사전 준비 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. 사전 준비</h1>\n<h2 id=\"31-lightsail-구매\" style=\"position:relative;\"><a href=\"#31-lightsail-%EA%B5%AC%EB%A7%A4\" aria-label=\"31 lightsail 구매 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.1. Lightsail 구매</h2>\n<p><a href=\"https://inpa.tistory.com/entry/AWS-%F0%9F%93%9A-Amazon-Lightsail-%EC%82%AC%EC%9A%A9%EB%B2%95-%EC%9B%B9%EC%84%9C%EB%B9%84%EC%8A%A4%EB%A5%BC-%EB%9A%9D%EB%94%B1-%EA%B5%AC%EC%B6%95%ED%95%98%EC%9E%90\">Inpa Dev님의 \"Lightsail 사용법 총정리\"</a> 문서에 너무나도 잘 정리되어 있다. 우리는 20달러 플랜, Ubuntu 20.04, 별도 추가구성 없이 구매했다.</p>\n<h2 id=\"32-k3s-설치\" style=\"position:relative;\"><a href=\"#32-k3s-%EC%84%A4%EC%B9%98\" aria-label=\"32 k3s 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3.2. k3s 설치</h2>\n<blockquote>\n<p>최신 내용은 꼭 <a href=\"https://docs.k3s.io/quick-start\">k3s 공식문서</a>를 확인하기 바람</p>\n</blockquote>\n<p>다음 명령어로 손쉽게 k3s를 설치할 수 있다. 서버 노드(마스터 노드)가 구현된다.</p>\n<pre><code class=\"language-sh\">curl -sfL https://get.k3s.io | sh -\n</code></pre>\n<p>만약 에이전트 노드(워커 노드)를 구성하고자 하면 아래 명령어를 실행한다. (에이전트 노드이기 때문에 마스터 노드가 이미 구성되어 있어야 한다.) <code>K3S_URL</code>은 마스터 노드의 URL을 의미하며, <code>K3S_TOKEN</code>은 일종의 인증 토큰으로 마스터 서버의 <code>/var/lib/rancher/k3s/server/node-token</code> 경로에서 확인할 수 있다.</p>\n<pre><code class=\"language-sh\"># 예시 코드\ncurl -sfL https://get.k3s.io | K3S_URL=https://myserver:6443 K3S_TOKEN=mynodetoken sh -\n</code></pre>\n<h1 id=\"참고자료\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\" aria-label=\"참고자료 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고자료</h1>\n<ul>\n<li><a href=\"https://docs.k3s.io/\">k3s 공식문서</a></li>\n<li><a href=\"https://inpa.tistory.com/entry/AWS-%F0%9F%93%9A-Amazon-Lightsail-%EC%82%AC%EC%9A%A9%EB%B2%95-%EC%9B%B9%EC%84%9C%EB%B9%84%EC%8A%A4%EB%A5%BC-%EB%9A%9D%EB%94%B1-%EA%B5%AC%EC%B6%95%ED%95%98%EC%9E%90\">Inpa Dev : \"Lightsail 사용법 총정리\"</a></li>\n</ul>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#1-%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8-%EA%B0%9C%EC%9A%94\">1. 프로젝트 개요</a></p>\n</li>\n<li>\n<p><a href=\"#2-%EC%95%84%ED%82%A4%ED%85%8D%EC%B3%90-%EA%B5%AC%EC%83%81%EB%8F%84\">2. 아키텍쳐 구상도</a></p>\n<ul>\n<li><a href=\"#21-lightsail-%EC%9D%B4%EB%9E%80\">2.1. Lightsail 이란?</a></li>\n<li><a href=\"#22-k3s-%EC%9D%B4%EB%9E%80\">2.2. k3s 이란?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#3-%EC%82%AC%EC%A0%84-%EC%A4%80%EB%B9%84\">3. 사전 준비</a></p>\n<ul>\n<li><a href=\"#31-lightsail-%EA%B5%AC%EB%A7%A4\">3.1. Lightsail 구매</a></li>\n<li><a href=\"#32-k3s-%EC%84%A4%EC%B9%98\">3.2. k3s 설치</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#%EC%B0%B8%EA%B3%A0%EC%9E%90%EB%A3%8C\">참고자료</a></p>\n</li>\n</ul>","frontmatter":{"title":"k3s 배포하기 (1) : 프로젝트 개요 & 사전 준비","createdAt":"2024-01-21","updatedAt":"2024-01-21","tags":["kubernetes","k3s","AWS","lightsail","DevOps","배포"],"description":"AWS 인스턴스에 k3s 단일 노드 클러스터를 구축해본다. 전체 프로젝트 아키텍쳐 및 사전 준비 과정을 알아보자","reference":null}},"allMarkdownRemark":{"nodes":[{"id":"353ab996-d3e6-5556-8c06-077b7b2f6370","excerpt":"1. 프로젝트 개요 백엔드 개발자 친구와 함께 쿠버네티스를 연습하기 위한 토이프로젝트를 만들었다. 명색이 쿠버네티스 프로젝트인데 MSA를 안할 수 없었다. 백엔드가 MSA로 바쁜데, 프론트가 가만히 있을 수 없어 Three.js…","parent":{"id":"9922ca6f-2e24-5b46-af05-3d732bdc680a","name":"k3s_1_intro","relativePath":"DevOps/Kubernetes/k3s_1_intro.md"},"frontmatter":{"title":"k3s 배포하기 (1) : 프로젝트 개요 & 사전 준비","createdAt":"2024-01-21","updatedAt":"2024-01-21"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_1_intro/"}},{"id":"8d4891d2-35c4-5d9e-ba8b-cbd3586aa466","excerpt":"프론트는 너무 간단하다. Next.js같은 풀스텍 프레임워크를 사용하면 좀 더 흥미로울 것 같다. 1. 도커 이미지 리액트 프로젝트를 빌드하면 정적 파일이 생성된다. 이러한 정적 컨텐츠를 서비스하기 위해서는 웹서버가 필요하다. 그래서 Nginx…","parent":{"id":"78f25f94-3f4b-51ed-8127-3ba754a426e0","name":"k3s_2_front","relativePath":"DevOps/Kubernetes/k3s_2_front.md"},"frontmatter":{"title":"k3s 배포하기 (2) : 프론트(React) 배포","createdAt":"2024-01-21","updatedAt":"2024-01-21"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_2_front/"}},{"id":"4fc2f125-d6bf-558f-a3ac-450a8111a5aa","excerpt":"본래 DB의 아이디와 패스워드는 쿠버네티스에서 Secret 등으로 관리해야 한다. Secret 생성과 적용은 이후 포스팅에서 따로 다룰 예정이다. 1. PV, PVC 쿠버네티스에서는 파드가 죽으면 알아서 다시 띄워준다. 그런데 MySQL…","parent":{"id":"497e574b-50c4-5789-b252-f5e123645d29","name":"k3s_3_mysql","relativePath":"DevOps/Kubernetes/k3s_3_mysql.md"},"frontmatter":{"title":"k3s 배포하기 (3) : 데이터베이스(MySQL) 배포","createdAt":"2024-01-22","updatedAt":"2024-01-22"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_3_mysql/"}},{"id":"105f9b57-232d-5894-b19b-9530e548ea7a","excerpt":"본래 DB의 아이디와 패스워드는 쿠버네티스에서 Secret으로 관리하는 것을 권장한다. Secret 생성과 적용은 이후 포스팅에서 따로 다룰 예정이다. 1. MSA 구조 백엔드는 MSA 구조로 설계되어 총 3개의 Spring Boot…","parent":{"id":"fc9e8efe-87a2-5ae4-9522-a7be3b623338","name":"k3s_4_back","relativePath":"DevOps/Kubernetes/k3s_4_back.md"},"frontmatter":{"title":"k3s 배포하기 (4) : 백엔드(Redis, Spring, Kafka) 배포","createdAt":"2024-01-22","updatedAt":"2024-01-22"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_4_back/"}},{"id":"b074c93c-6fee-597f-84a0-4ae2ca498c4e","excerpt":"1. 인그레스 삽질기⚒️ 이 항목은 k3s를 사용할 경우 참고하지 않아도 되는 삽질기입니다. 우리는 k3s…","parent":{"id":"cf6e57cc-27bd-5a23-a936-4c1be07c330f","name":"k3s_5_ingress","relativePath":"DevOps/Kubernetes/k3s_5_ingress.md"},"frontmatter":{"title":"k3s 배포하기 (5) : Traefik 인그레스 설정","createdAt":"2024-01-23","updatedAt":"2024-01-23"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_5_ingress/"}},{"id":"6f01b89a-ec71-5dfa-b6a3-8bf60f330a93","excerpt":"1. Cert Manager Cert Manager는 쿠버네티스에서 SSL/TLS 인증서를 관리하기 위한 오픈 소스 도구이다. Let's Encrypt와 같은 인증 기관을 사용하여 인증서를 발급하고 갱신하는 작업을 자동화한다. 개인적으로 Certbot…","parent":{"id":"fee655a1-4c88-55d5-b977-a0a4688b4e3b","name":"k3s_6_cert_manager","relativePath":"DevOps/Kubernetes/k3s_6_cert_manager.md"},"frontmatter":{"title":"k3s 배포하기 (6) : Cert Manager 등록","createdAt":"2024-01-23","updatedAt":"2024-01-23"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_6_cert_manager/"}},{"id":"df9bb52a-2328-5c01-a25b-870413c2fc5a","excerpt":"1. Secret 이란? Secret은 쿠버네티스 클러스터에서 비밀번호와 같은 민감한 데이터를 관리하기 위한 객체이다. 쿠버네티스 클러스터 내에서 마치 환경변수처럼 동작하기 때문에, 여러 Pod에서 독립적으로 값을 참조할 수 있다. 값을 yml…","parent":{"id":"176dffb2-6e59-5b17-aa12-1724f04ed480","name":"k3s_7_secret","relativePath":"DevOps/Kubernetes/k3s_7_secret.md"},"frontmatter":{"title":"k3s 배포하기 (7) : Secret 등록","createdAt":"2024-01-28","updatedAt":"2024-01-28"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_7_secret/"}}]}},"pageContext":{"pagePath":"/posts/DevOps/Kubernetes/k3s_1_intro/","siblingPostsPathRegex":"/^(?!.*README).*DevOps\\/Kubernetes\\/.*$/","relativeDirectory":"Kubernetes","id":"353ab996-d3e6-5556-8c06-077b7b2f6370","parent":{"id":"9922ca6f-2e24-5b46-af05-3d732bdc680a","name":"k3s_1_intro","relativePath":"DevOps/Kubernetes/k3s_1_intro.md"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_1_intro/"}}},"staticQueryHashes":["24302420","4059933791"],"slicesMap":{}}