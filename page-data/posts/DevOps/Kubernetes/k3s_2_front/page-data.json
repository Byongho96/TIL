{"componentChunkName":"component---src-templates-post-index-tsx","path":"/posts/DevOps/Kubernetes/k3s_2_front/","result":{"data":{"markdownRemark":{"id":"8d4891d2-35c4-5d9e-ba8b-cbd3586aa466","html":"<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/TIL/static/b9f4578ab1c98f7332a232a35c28ef1b/2bef9/architecture-front.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 70.28571428571428%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAYAAAAvxDzwAAAACXBIWXMAAAsTAAALEwEAmpwYAAABy0lEQVR42n2UDW7bMAyFc//b7EAF1mErEjiJY1ui/kh+g5SsyYo0AghbFPX0HkVqBzhfhpmxLAu5KZP4CLCWKTlj7QP3zDfDd59/1vAquFa8ZnJYaFmIkkArNW1I98kBbzJ8aPnfcHZ3Woqvv2D9CemMpxlPZ8hnLJ5Arl8N57FOOoI82qlLewB0g7jH2zQk1bQisqCWMRpQUJUx9xawPAMCHsEF6jpIPQAqpAugY7NrhBp4E+HH8c/wNe25a5TTnvT7vcsC71LrHbCUTAgB04puE6qRUgNzSdQSiF55i0fwzJYn1jRRSkCb0CwT84paZ7hdAVtrlFJuDM+DiXlmKUKukdZWzCK1ygCUNtM6mKYRWzVhneVzyfMIGpI9416I5UwoJ1oVqm6oRZJEUorjYLOEk+8MvwPUka8ygs3TALyk/ZWlxGGdXcgBtfQaUK3wfuhybmy7b8gMqMuQ3w3y5/oLyRXzyhyuwOMGqWhLzPLBkidy6ReSaF6QGoaC5wx7AWsY5hahl86Yb9Bl9/rrG1VuaxFtAe8x+fIFsHfsrYVcCymsaInXFrMKve2mA5d0veVXrffkcXBOS6/H+u8oWBbYHzj4hoxUPB32F5t1Sw0FF2zpAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/TIL/static/b9f4578ab1c98f7332a232a35c28ef1b/c54d4/architecture-front.webp 175w,\n/TIL/static/b9f4578ab1c98f7332a232a35c28ef1b/a3432/architecture-front.webp 350w,\n/TIL/static/b9f4578ab1c98f7332a232a35c28ef1b/426ac/architecture-front.webp 700w,\n/TIL/static/b9f4578ab1c98f7332a232a35c28ef1b/a9a89/architecture-front.webp 1024w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/webp\">\n          <source srcset=\"/TIL/static/b9f4578ab1c98f7332a232a35c28ef1b/4edbd/architecture-front.png 175w,\n/TIL/static/b9f4578ab1c98f7332a232a35c28ef1b/13ae7/architecture-front.png 350w,\n/TIL/static/b9f4578ab1c98f7332a232a35c28ef1b/8c557/architecture-front.png 700w,\n/TIL/static/b9f4578ab1c98f7332a232a35c28ef1b/2bef9/architecture-front.png 1024w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/TIL/static/b9f4578ab1c98f7332a232a35c28ef1b/8c557/architecture-front.png\" alt=\"프로젝트 아키텍쳐 구상도\" title=\"\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span>\n<blockquote>\n<p>프론트는 너무 간단하다. Next.js같은 풀스텍 프레임워크를 사용하면 좀 더 흥미로울 것 같다.</p>\n</blockquote>\n<h1 id=\"1-도커-이미지\" style=\"position:relative;\"><a href=\"#1-%EB%8F%84%EC%BB%A4-%EC%9D%B4%EB%AF%B8%EC%A7%80\" aria-label=\"1 도커 이미지 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 도커 이미지</h1>\n<p>리액트 프로젝트를 빌드하면 정적 파일이 생성된다. 이러한 정적 컨텐츠를 서비스하기 위해서는 웹서버가 필요하다. 그래서 Nginx 이미지를 이용해서 리액트 도커를 만들었다.</p>\n<h2 id=\"11-nginxconf\" style=\"position:relative;\"><a href=\"#11-nginxconf\" aria-label=\"11 nginxconf permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.1. nginx.conf</h2>\n<p>먼저 nginx 설정 파일부터 작성한다. <code>빌드 폴더 복사 위치</code>는 nginx 이미지 내부 경로를 말하며, 임의로 지정해주고 이후 Dockefile과 일치시키면 된다.</p>\n<pre><code class=\"language-conf\">server {\n    listen 80;\n    server_name localhost;\n\n    location / {\n        root {빌드 폴더 복사 위치};\n        index index.html;\n        try_files $uri $uri/ /index.html;\n    }\n}\n</code></pre>\n<h2 id=\"12-dockerfile\" style=\"position:relative;\"><a href=\"#12-dockerfile\" aria-label=\"12 dockerfile permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.2. Dockerfile</h2>\n<p>리액트 앱 빌드는 이미 완료한 채로 Dockerfile을 작성했다. 이후 구축할 CI/CD 파이프라인이 빌드 작업을 담당할 것이기 때문이다.</p>\n<pre><code class=\"language-Dockerfile\"># nginx 이미지를 베이스 이미지로 사용\nFROM nginx:alpine\n\n# 리액트 빌드 파일 복사\nCOPY {빌드 폴더 상대경로} {빌드 폴더 복사 위치}\n\n# 기존 nginx 설정 제거\nRUN rm /etc/nginx/conf.d/default.conf\n\n# 커스텀 nginx 설정 복사\nCOPY {nginx 설정 상대경로} /etc/nginx/conf.d/\n\n# 80번 포트로 수신\nEXPOSE 80\n\n# 컨테이너 생성 시, nginx 실행\nCMD [\"nginx\", \"-g\", \"daemon off;\"]\n</code></pre>\n<h2 id=\"13-이미지-빌드--푸시\" style=\"position:relative;\"><a href=\"#13-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%B9%8C%EB%93%9C--%ED%91%B8%EC%8B%9C\" aria-label=\"13 이미지 빌드  푸시 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1.3. 이미지 빌드 &#x26; 푸시</h2>\n<p>Dockerhub 계정을 만들고, 계정 이름을 이미지 이름앞에 붙여줘야 한다. <code>Dockerhub계정/이미지이름</code> 형식으로 이미지 이름을 지어야한다.</p>\n<pre><code class=\"language-sh\"># 이미지 빌드\ndocker build -t {이미지 이름} {Dockerfile 위치}\n</code></pre>\n<pre><code class=\"language-sh\"># 이미지 푸시\ndocker push {이미지 이름}\n</code></pre>\n<h1 id=\"2-k3s-등록\" style=\"position:relative;\"><a href=\"#2-k3s-%EB%93%B1%EB%A1%9D\" aria-label=\"2 k3s 등록 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. k3s 등록</h1>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 700px; margin-bottom: 20px;\">\n      <a class=\"gatsby-resp-image-link\" href=\"/TIL/static/1c550da977066eab31bafaaa57606165/5a190/k8s-service-deployment.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 45.714285714285715%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsTAAALEwEAmpwYAAABo0lEQVR42k2R3W+TYBSH9597450xmnSLyZIZo/WqFybTuW50XRNXGloK/aC1qKNhyMdLoUD5euH9MjBi+svJuXl+z805J6wOpdV2rVjijZVkK6Ilj4xwn9WoYvpvX+aNtewsJ9ZibBYQMcZOjmXgJPOpu5AtZQbmUxAG8D/StXAhVWg5A0vZLQp8LFeV1PbARDXGa1tUwWQDg7hCpELhowlE9UlY2eLGlX5hWB7JdcOWNKl1uWrfKR9up6ffAg3UiDDGtNvZ7N1Xpd1bvu/K510YZY1cEmI6Dzic01yLshy4+12YJ5nPCuNQJLbZY5mOcy1ICwd4XlTm6V9Wuo18gNFH4VWUGNaTyP9o9Uc3A74zHp4le0PzN53pKUGJ+rMvPLzlRgN+9EkSLvLUa+Qg8S+E10G2U3Vwff3yst/53ju/4lrAg487pS2eIYyG8zV38+LL/RXXe9MdfI5z2sgpTIZbLi1jCIut7Vk733C8P4YNs9xN7LF+zxg9xPHW9oC310zXdH1KSSMjhCmhqE51d0KeByGE8TPChODqqpQSjJvvMfYPw3vmWa4kf+QAAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/TIL/static/1c550da977066eab31bafaaa57606165/c54d4/k8s-service-deployment.webp 175w,\n/TIL/static/1c550da977066eab31bafaaa57606165/a3432/k8s-service-deployment.webp 350w,\n/TIL/static/1c550da977066eab31bafaaa57606165/426ac/k8s-service-deployment.webp 700w,\n/TIL/static/1c550da977066eab31bafaaa57606165/d00b9/k8s-service-deployment.webp 800w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/webp\">\n          <source srcset=\"/TIL/static/1c550da977066eab31bafaaa57606165/4edbd/k8s-service-deployment.png 175w,\n/TIL/static/1c550da977066eab31bafaaa57606165/13ae7/k8s-service-deployment.png 350w,\n/TIL/static/1c550da977066eab31bafaaa57606165/8c557/k8s-service-deployment.png 700w,\n/TIL/static/1c550da977066eab31bafaaa57606165/5a190/k8s-service-deployment.png 800w\" sizes=\"(max-width: 700px) 100vw, 700px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/TIL/static/1c550da977066eab31bafaaa57606165/8c557/k8s-service-deployment.png\" alt=\"쿠버네티스 서비스와 디플로이먼트 개념도\" title=\"\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span>\n<p>Deployment 설정 파일로 Replica Set과 Pod까지 다룰 수 있다. 우리는 현재 Pod을 하나 씩만 띄어도 메모리가 간당간당하기 때문에 따로 Replica Set을 늘리지는 않았다. 또한 기본적으로 모든 어플리케이션은 Service 오브젝트를 두어 서비스 이름으로 통신할 수 있도록 했다.</p>\n<pre><code class=\"language-yml\">apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: react-dp\nspec:\n  selector:\n    matchLabels:\n      app: react\n  template:\n    metadata:\n      labels:\n        app: react\n    spec:\n      containers:\n        - image: { 이미지 이름 }\n          name: react\n          ports:\n            - containerPort: 80\n\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: react-svc\nspec:\n  ports:\n    - port: 80\n  selector:\n    app: react\n</code></pre>\n<pre><code class=\"language-sh\"># 쿠버네티스 등록\nkubectl apply -f react.yml\n</code></pre>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#1-%EB%8F%84%EC%BB%A4-%EC%9D%B4%EB%AF%B8%EC%A7%80\">1. 도커 이미지</a></p>\n<ul>\n<li><a href=\"#11-nginxconf\">1.1. nginx.conf</a></li>\n<li><a href=\"#12-dockerfile\">1.2. Dockerfile</a></li>\n<li><a href=\"#13-%EC%9D%B4%EB%AF%B8%EC%A7%80-%EB%B9%8C%EB%93%9C--%ED%91%B8%EC%8B%9C\">1.3. 이미지 빌드 &#x26; 푸시</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#2-k3s-%EB%93%B1%EB%A1%9D\">2. k3s 등록</a></p>\n</li>\n</ul>","frontmatter":{"title":"k3s 배포하기 (2) : 프론트(React) 배포","createdAt":"2024-01-21","updatedAt":"2024-01-21","tags":["kubernetes","k3s","AWS","lightsail","DevOps","React"],"description":"AWS 인스턴스에 k3s 단일 노드 클러스터를 구축해본다. 프론트 리액트 어플리케이션을 k3s에 등록해보자","reference":null}},"allMarkdownRemark":{"nodes":[{"id":"353ab996-d3e6-5556-8c06-077b7b2f6370","excerpt":"1. 프로젝트 개요 백엔드 개발자 친구와 함께 쿠버네티스를 연습하기 위한 토이프로젝트를 만들었다. 명색이 쿠버네티스 프로젝트인데 MSA를 안할 수 없었다. 백엔드가 MSA로 바쁜데, 프론트가 가만히 있을 수 없어 Three.js…","parent":{"id":"9922ca6f-2e24-5b46-af05-3d732bdc680a","name":"k3s_1_intro","relativePath":"DevOps/Kubernetes/k3s_1_intro.md"},"frontmatter":{"title":"k3s 배포하기 (1) : 프로젝트 개요 & 사전 준비","createdAt":"2024-01-21","updatedAt":"2024-01-21"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_1_intro/"}},{"id":"8d4891d2-35c4-5d9e-ba8b-cbd3586aa466","excerpt":"프론트는 너무 간단하다. Next.js같은 풀스텍 프레임워크를 사용하면 좀 더 흥미로울 것 같다. 1. 도커 이미지 리액트 프로젝트를 빌드하면 정적 파일이 생성된다. 이러한 정적 컨텐츠를 서비스하기 위해서는 웹서버가 필요하다. 그래서 Nginx…","parent":{"id":"78f25f94-3f4b-51ed-8127-3ba754a426e0","name":"k3s_2_front","relativePath":"DevOps/Kubernetes/k3s_2_front.md"},"frontmatter":{"title":"k3s 배포하기 (2) : 프론트(React) 배포","createdAt":"2024-01-21","updatedAt":"2024-01-21"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_2_front/"}},{"id":"4fc2f125-d6bf-558f-a3ac-450a8111a5aa","excerpt":"본래 DB의 아이디와 패스워드는 쿠버네티스에서 Secret 등으로 관리해야 한다. Secret 생성과 적용은 이후 포스팅에서 따로 다룰 예정이다. 1. PV, PVC 쿠버네티스에서는 파드가 죽으면 알아서 다시 띄워준다. 그런데 MySQL…","parent":{"id":"497e574b-50c4-5789-b252-f5e123645d29","name":"k3s_3_mysql","relativePath":"DevOps/Kubernetes/k3s_3_mysql.md"},"frontmatter":{"title":"k3s 배포하기 (3) : 데이터베이스(MySQL) 배포","createdAt":"2024-01-22","updatedAt":"2024-01-22"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_3_mysql/"}},{"id":"105f9b57-232d-5894-b19b-9530e548ea7a","excerpt":"본래 DB의 아이디와 패스워드는 쿠버네티스에서 Secret 등으로 관리해야 한다. Secret 생성과 적용은 이후 포스팅에서 따로 다룰 예정이다. 1. MSA 구조 백엔드는 MSA 구조로 설계되어 총 3개의 Spring Boot…","parent":{"id":"fc9e8efe-87a2-5ae4-9522-a7be3b623338","name":"k3s_4_back","relativePath":"DevOps/Kubernetes/k3s_4_back.md"},"frontmatter":{"title":"k3s 배포하기 (4) : 백엔드(Redis, Spring, Kafka) 배포","createdAt":"2024-01-22","updatedAt":"2024-01-22"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_4_back/"}},{"id":"b074c93c-6fee-597f-84a0-4ae2ca498c4e","excerpt":"1. 인그레스 삽질기⚒️ 이 항목은 k3s를 사용할 경우 참고하지 않아도 되는 삽질기입니다. 우리는 k3s…","parent":{"id":"cf6e57cc-27bd-5a23-a936-4c1be07c330f","name":"k3s_5_ingress","relativePath":"DevOps/Kubernetes/k3s_5_ingress.md"},"frontmatter":{"title":"k3s 배포하기 (5) : Traefik 인그레스 설정","createdAt":"2024-01-23","updatedAt":"2024-01-23"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_5_ingress/"}},{"id":"6f01b89a-ec71-5dfa-b6a3-8bf60f330a93","excerpt":"1. Cert Manager Cert Manager는 쿠버네티스에서 SSL/TLS 인증서를 관리하기 위한 오픈 소스 도구이다. Let's Encrypt와 같은 인증 기관을 사용하여 인증서를 발급하고 갱신하는 작업을 자동화한다. 개인적으로 Certbot…","parent":{"id":"fee655a1-4c88-55d5-b977-a0a4688b4e3b","name":"k3s_6_cert_manager","relativePath":"DevOps/Kubernetes/k3s_6_cert_manager.md"},"frontmatter":{"title":"k3s 배포하기 (6) : Cert Manager 등록","createdAt":"2024-01-23","updatedAt":"2024-01-23"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_6_cert_manager/"}}]}},"pageContext":{"pagePath":"/posts/DevOps/Kubernetes/k3s_2_front/","siblingPostsPathRegex":"/^(?!.*README).*DevOps\\/Kubernetes\\/.*$/","relativeDirectory":"Kubernetes","id":"8d4891d2-35c4-5d9e-ba8b-cbd3586aa466","parent":{"id":"78f25f94-3f4b-51ed-8127-3ba754a426e0","name":"k3s_2_front","relativePath":"DevOps/Kubernetes/k3s_2_front.md"},"fields":{"slug":"/posts/DevOps/Kubernetes/k3s_2_front/"}}},"staticQueryHashes":["24302420","4059933791"],"slicesMap":{}}