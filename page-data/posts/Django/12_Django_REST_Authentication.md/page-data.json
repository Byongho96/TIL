{"componentChunkName":"component---src-templates-post-tsx","path":"/posts/Django/12_Django_REST_Authentication.md/","result":{"data":{"markdownRemark":{"id":"0292a74d-369f-5a21-8f8a-e3e51cb8011a","html":"<h1>Django REST Authentication</h1>\n<h2>Index</h2>\n<ul>\n<li><a href=\"#1-cors\">1. CORS</a>\n<ul>\n<li><a href=\"#11-same-origin-policy\">1.1. Same Origin Policy</a></li>\n<li><a href=\"#12-definition-of-origin\">1.2. Definition of Origin</a></li>\n<li><a href=\"#13-cors\">1.3. CORS</a>\n<ul>\n<li><a href=\"#131-django-cors-headers\">1.3.1. django-cors-headers</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#2-authentication\">2. Authentication</a>\n<ul>\n<li><a href=\"#21-authentication-class\">2.1. Authentication Class</a></li>\n<li><a href=\"#22-permission-class\">2.2. Permission Class</a></li>\n</ul>\n</li>\n<li><a href=\"#3-dj-rest-auth\">3. dj-rest-auth</a>\n<ul>\n<li><a href=\"#31-installation\">3.1. Installation</a></li>\n<li><a href=\"#32-registration\">3.2. Registration</a></li>\n</ul>\n</li>\n</ul>\n<hr>\n<h1>1. CORS</h1>\n<h2>1.1. Same Origin Policy</h2>\n<p>The same-origin policy is a critical security mechanism <strong>by browsers</strong> that restricts how a document or script loaded by one origin can interact with a resource from another origin.</p>\n<h2>1.2. Definition of Origin</h2>\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 618px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/TIL/static/a6e778fca716f0a0d863673c2b34127e/ac42d/same_origin.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 32%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAGABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAduCLCf/xAAXEAADAQAAAAAAAAAAAAAAAAAAARES/9oACAEBAAEFAm4VGj//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAVEQEBAAAAAAAAAAAAAAAAAAAQQf/aAAgBAgEBPwGH/8QAFhAAAwAAAAAAAAAAAAAAAAAAABAx/9oACAEBAAY/AiL/xAAYEAEBAQEBAAAAAAAAAAAAAAABABEhQf/aAAgBAQABPyF1AdDsb8v/2gAMAwEAAgADAAAAEAQv/8QAFxEAAwEAAAAAAAAAAAAAAAAAAAERMf/aAAgBAwEBPxB6in//xAAXEQEAAwAAAAAAAAAAAAAAAAAAARFB/9oACAECAQE/ENSt/8QAGRABAAMBAQAAAAAAAAAAAAAAAQARUSEx/9oACAEBAAE/EBZd33yMpAvpkYLrZ//Z'); background-size: cover; display: block;\"></span>\n  <img class=\"gatsby-resp-image-image\" alt=\"same origin\" title=\"\" src=\"/TIL/static/a6e778fca716f0a0d863673c2b34127e/ac42d/same_origin.jpg\" srcset=\"/TIL/static/a6e778fca716f0a0d863673c2b34127e/e07e9/same_origin.jpg 200w,\n/TIL/static/a6e778fca716f0a0d863673c2b34127e/066f9/same_origin.jpg 400w,\n/TIL/static/a6e778fca716f0a0d863673c2b34127e/ac42d/same_origin.jpg 618w\" sizes=\"(max-width: 618px) 100vw, 618px\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\" loading=\"lazy\" decoding=\"async\">\n  </a>\n    </span>\n<h2>1.3. CORS</h2>\n<p>Cross-Origin Resource Sharing (CORS) is <strong>an HTTP-header based mechanism that</strong> allows a server to indicate any origins (domain, scheme, or port) other than its own from which a browser should permit loading resources.</p>\n<p><strong>The server determines which origins are accessible to its resources.</strong></p>\n<h3>1.3.1. django-cors-headers</h3>\n<p><strong>Library to add CORS header to response</strong></p>\n<ul>\n<li>\n<p><strong>Procedure</strong></p>\n<ol>\n<li>\n<p><code>pip install django-cors-headers</code></p>\n</li>\n<li>\n<p>Add to <code>INSTALLED_APPS</code> and <code>MIDDLEWARE</code></p>\n<pre><code class=\"language-python\">INSTALLED_APPS = [\r\n    ...,\r\n    \"corsheaders\",\r\n    ...,\r\n]\r\n\r\nMIDDLEWARE = [\r\n    ...,\r\n    \"corsheaders.middleware.CorsMiddleware\",\r\n    \"django.middleware.common.CommonMiddleware\",\r\n    ...,\r\n]\n</code></pre>\n</li>\n<li>\n<p>Register the accessible domains</p>\n<pre><code class=\"language-python\">CORS_ALLOWED_ORIGINS = [\r\n    \"https://example.com\",\r\n     ...\r\n]\r\n\r\n# CORS_ALLOW_ALL_ORIGINS = True\n</code></pre>\n</li>\n</ol>\n</li>\n</ul>\n<hr>\n<h1>2. Authentication</h1>\n<p><a href=\"https://www.django-rest-framework.org/api-guide/authentication/\">django REST framework Authentication</a></p>\n<h2>2.1. Authentication Class</h2>\n<p>REST framework will attempt to authenticate with each class in the list.</p>\n<pre><code class=\"language-python\">REST_FRAMEWORK = {\r\n    # Authentication\r\n    'DEFAULT_AUTHENTICATION_CLASSES': [\r\n        # ID and Password\r\n        'rest_framework.authentication.BasicAuthentication',\r\n        # Session\r\n        'rest_framework.authentication.SessionAuthentication',\r\n        # Token\r\n        'rest_framework.authentication.TokenAuthentication',\r\n    ],\r\n}\n</code></pre>\n<h2>2.2. Permission Class</h2>\n<p><a href=\"https://www.django-rest-framework.org/api-guide/permissions/#api-reference\">Permission Classes</a></p>\n<p>Permissions determine whether a request should be granted or denied access. Permissions in REST framework are always defined as a list of permission classes.</p>\n<pre><code class=\"language-python\">REST_FRAMEWORK = {\r\n    # Permission\r\n    'DEFAULT_PERMISSION_CLASSES': [\r\n        # 'rest_framework.permissions.IsAuthenticated',\r\n        'rest_framework.permissions.AllowAny',  # 모든 요청에 대해 허용 후, url 개별적으로 제한\r\n    ],\r\n}\n</code></pre>\n<pre><code class=\"language-python\">@permission_classes([IsAuthenticated])\r\ndef example_view(request, format=None):\r\n    content = {\r\n        'user': str(request.user),  # `django.contrib.auth.User` instance.\r\n        'auth': str(request.auth),  # None\r\n    }\r\n    return Response(content)\n</code></pre>\n<hr>\n<h1>3. dj-rest-auth</h1>\n<p><a href=\"https://dj-rest-auth.readthedocs.io/en/latest/index.html\">dj-rest-auth doc</a>\r\nThe library that provides REST API end points related to authentication</p>\n<h2>3.1. Installation</h2>\n<ol>\n<li>User should be customized before start.\n<pre><code class=\"language-python\">AUTH_USER_MODEL = 'accounts.User'\n</code></pre>\n</li>\n<li><code>pip install dj-rest-auth</code></li>\n<li>Add dj_rest_auth app to INSTALLED_APPS in your django settings\n<pre><code class=\"language-python\">    INSTALLED_APPS = (\r\n    ...,\r\n    'rest_framework',\r\n    'rest_framework.authtoken',\r\n    ...,\r\n    'dj_rest_auth'\r\n)\n</code></pre>\n</li>\n<li>Add dj_rest_auth urls\n<pre><code class=\"language-python\">urlpatterns = [\r\n...,\r\npath('dj-rest-auth/', include('dj_rest_auth.urls'))\r\n]\n</code></pre>\n</li>\n<li><code>python manage.py migrate</code></li>\n</ol>\n<h2>3.2. Registration</h2>\n<p>Additional packages must be installed to add a membership registration function.</p>\n<ol>\n<li>\n<p><code>pip install 'dj-rest-auth[with_social]'</code></p>\n</li>\n<li>\n<p>Add apps to INSTALLED_APPS in your django settings</p>\n<pre><code class=\"language-python\">INSTALLED_APPS = [\r\n...,\r\n'django.contrib.sites',\r\n'allauth',\r\n'allauth.account',\r\n'allauth.socialaccount',\r\n'dj_rest_auth.registration',\r\n]\n</code></pre>\n</li>\n<li>\n<p>Add SITE_ID = 1 to your django settings</p>\n<pre><code class=\"language-python\">SITE_ID = 1\n</code></pre>\n</li>\n<li>\n<p>Add dj_rest_auth.registration urls</p>\n<pre><code class=\"language-python\">urlpatterns = [\r\n...,\r\npath('dj-rest-auth/', include('dj_rest_auth.urls')),\r\npath('dj-rest-auth/registration/', include('dj_rest_auth.registration.urls'))\r\n]\n</code></pre>\n</li>\n<li>\n<p><code>python manage.py migrate</code></p>\n</li>\n</ol>"}},"pageContext":{"pagePath":"posts/Django/12_Django_REST_Authentication.md","id":"0292a74d-369f-5a21-8f8a-e3e51cb8011a","parent":{"id":"bf3bb2d9-8b4d-5b47-9bf8-2aed3468c6e5","name":"12_Django_REST_Authentication","relativePath":"Django/12_Django_REST_Authentication.md"}}},"staticQueryHashes":["1274812890","3935499650","82772122"],"slicesMap":{}}