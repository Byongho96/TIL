---
title: '11. Gatsby ëŒ“ê¸€ ë° ì¢‹ì•„ìš” ê¸°ëŠ¥'
updatedAt: '2023-07-02'
createdAt: '2023-07-02'
isCompleted: true
description: 'Gatsby ì›¹ì‚¬ì´íŠ¸ì— ëŒ“ê¸€ê³¼ ì¢‹ì•„ìš” ê¸°ëŠ¥ì„ êµ¬í˜„í•œë‹¤.'
tags: ['gatsby', 'ëŒ“ê¸€', 'ì¢‹ì•„ìš”', 'ëŒ€ëŒ“ê¸€', 'giscus', 'utterances']
reference: 'https://ricale.kr/blog/posts/230211-gatsby-8-comments/'
---

# 1. Utterancesì™€ Giscus

ë”°ë¡œ ì„œë²„ë¥¼ ëŒë¦¬ì§€ ì•Šê³ ì„œëŠ” ëŒ“ê¸€/ì¢‹ì•„ìš” ê¸°ëŠ¥ì„ êµ¬í˜„í•  ìˆ˜ ì—†ì„ ì¤„ ì•Œì•˜ë‹¤.

ê·¸ëŸ°ë° í•­ìƒ ê°œë°œìë“¤ì€ ì‹ ë°•í•œ ë°©ë²•ì„ ì°¾ì•„ë‚¸ë‹¤.  
**GitHub API**ë¥¼ ì´ìš©í•´ì„œ êµ¬í˜„ëœ ì„œë¹„ìŠ¤ê°€ ìˆì—ˆë‹¤. ê·¸ê²ƒë„ ë‘ ê°œë‚˜ ë§ì´ë‹¤!

- **Utterances**  
  [Utterances](https://utteranc.es/)ëŠ” GitHubì˜ ì´ìŠˆ(Issue)ë¥¼ í™œìš©í•´ì„œ ëŒ“ê¸€ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•œë‹¤. ì›ë˜ ê¹ƒí—™ ì´ìŠˆë€, ì½”ë“œ ë° í”„ë¡œì íŠ¸ì— ëŒ€í•œ ë¬¸ì œì ì´ë‚˜ ê°œì„ ì‚¬í•­ì„ ì œì•ˆí•˜ê³ , ì´ì— ëŒ€í•´ ë…¼ì˜í•˜ê³  ìœ„í•œ ê¸°ëŠ¥ì´ë‹¤. ë”°ë¼ì„œ ì´ìŠˆëŠ” ë ˆì´ë¸”, ë§ˆì¼ìŠ¤í†¤, ì´ìŠˆ ìƒíƒœ, ë‹´ë‹¹ì ë“±ì˜ ë‹¤ì–‘í•œ ì‘ì—…ì¶”ì  ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.

- **Giscus**  
  [Giscus](https://giscus.app/)ëŠ” GitHubì˜ í† ë¡ (Discussion)ì„ ì´ìš©í•´ì„œ êµ¬í˜„ëœ ì„œë¹„ìŠ¤ì´ë‹¤. ì›ë˜ ê¹ƒí—™ í† ë¡ ë„, í”„ë¡œì íŠ¸ì™€ ê´€ë ¨ëœ ì£¼ì œì— ëŒ€í•´ì„œ ì˜ê²¬ì„ êµí™˜í•˜ê¸° ìœ„í•œ ê¸°ëŠ¥ì´ë‹¤. ê¹ƒí—™ ì´ìŠˆì²˜ëŸ¼ ì‘ì—…ì¶”ì  ê¸°ëŠ¥ì€ ì œê³µë˜ì§€ ì•Šì§€ë§Œ, ë” ììœ ë¡­ê²Œ ì˜ê²¬ì„ êµí™˜í•  ìˆ˜ ìˆë‹¤.

ì§ê´€ì ì¸ ì‚¬ìš© ê¸°ëŠ¥ì„ ë¹„êµí•˜ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.

|             | Utterances         | Giscus             |
| ----------- | ------------------ | ------------------ |
| ëŒ“ê¸€        | :heavy_check_mark: | :heavy_check_mark: |
| ëŒ“ê¸€ ì¢‹ì•„ìš” | :heavy_check_mark: | :heavy_check_mark: |
| ë§ˆí¬ë‹¤ìš´    | :heavy_check_mark: | :heavy_check_mark: |
| í…Œë§ˆ        | :heavy_check_mark: | :heavy_check_mark: |
| ëŒ€ëŒ“ê¸€      | :x:                | :heavy_check_mark: |
| ì¢‹ì•„ìš”      | :x:                | :heavy_check_mark: |
| ë‹¤êµ­ì–´      | :x:                | :heavy_check_mark: |

ë³´ë©´ Utterancesë¥¼ ì‚¬ìš©í•  ì´ìœ ê°€ ì—†ì–´ë³´ì¸ë‹¤. ê·¸ëŸ°ë° **í˜„ì¬ ì„œë¹„ìŠ¤ì˜ ì•ˆì •ì„±ì´ë‚˜ ìœ ì§€ ë³´ìˆ˜ ì¸¡ë©´ì—ì„œëŠ” Utterancesê°€ ë” ë‚«ë‹¤.** ì¼ë‹¨, [ê³µì‹ë¬¸ì„œ](https://giscus.app/)ë§Œ ë“¤ì–´ê°€ë´ë„ GsiscusëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‹œì¸í•˜ê³  ìˆë‹¤.

> giscus is still under active development. GitHub is also still actively developing Discussions and its API. Thus, some features of giscus may break or change over time.

ì•„ë˜ [ì§€í‘œ](https://www.libhunt.com/compare-giscus-vs-utterances)ê°€ í˜„ì¬ Utterancesì™€ Giscusì˜ í˜„í™©ì„ ì˜ í‘œí˜„í•´ì£¼ëŠ” ê²ƒ ê°™ë‹¤. Utterances ì´ë¯¸ ë©˜ì…˜íšŸìˆ˜ê°€ ë§ê³  Starsë„ ë§ì´ ë°›ì•˜ì§€ë§Œ, ì„±ì¥ì„¸ëŠ” ë¹„êµì  ì™„ë§Œí•˜ë‹¤. ë°˜ëŒ€ë¡œ GiscusëŠ” ìƒëŒ€ì ìœ¼ë¡œ ì•„ì§ ëœ ì£¼ëª©ë°›ì§€ë§Œ, ì„±ì¥ì„¸ëŠ” ê°€íŒŒë¥´ë‹¤.

<img src="./images/giscus-vs-utterances.png" alt="giscus-vs-utterances.png" width=600/>

ë‚˜ëŠ” ì›ë˜ Utterancesë¥¼ ì ìš”í–ˆë‹¤ê°€, ì¢‹ì•„ìš” ê¸°ëŠ¥ì´ ë„ˆë¬´ íƒë‚˜ì„œ Giscusë¡œ ì´ì „í–ˆë‹¤.

## 1.1. ë™ì‘ ì›ë¦¬

Utterancesì™€ Giscus ëª¨ë‘ **npm ë¼ì´ë¸ŒëŸ¬ê°€ ì•„ë‹ˆë‹¤.** ê·¸ëƒ¥ í•˜ë‚˜ì˜ `<script>`íƒœê·¸ë§Œ ì£¼ì–´ì§„ë‹¤.

ì´ `<script>`íƒœê·¸ë¥¼ htmlì—ì„œ ì›í•˜ëŠ” ê³³ì— ì‚½ì…í•˜ë©´ ë§ˆë²•ì²˜ëŸ¼ ëŒ“ê¸€ UIê°€ ë‚˜íƒ€ë‚œë‹¤. ì²˜ìŒì—ëŠ” ì´ëŸ° ë™ì‘ê³¼ì •ì´ ìµìˆ™í•˜ì§€ ì•Šì•„ ì–´ë–»ê²Œ ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ì•¼ í• ì§€ ê°ì´ ì˜¤ì§€ ì•Šì•˜ë‹¤. ê·¸ëŸ°ë° ì¢€ë§Œ ì‹œê°„ì„ ê°–ê³  ì•Œì•„ë³´ë‹ˆ, ìƒ‰ë‹¤ë¥´ë©´ì„œë„ ì¬ë°Œê²Œ ë™ì‘í•˜ëŠ” ì„œë¹„ìŠ¤ì˜€ë‹¤.

<mark>Utterancesì™€ GiscusëŠ” ì„œë¡œ ë§¤ìš° ìœ ìƒ¤í•˜ê²Œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì—, Utterancesë¥¼ ì˜ˆì‹œë¡œ ë™ì‘ê³¼ì •ì„ ì„¤ëª…í•´ë³´ê² ë‹¤.</mark>

ë‹¤ìŒì€ utterancesì˜ ì˜ˆì‹œ ìŠ¤í¬ë¦½íŠ¸ì´ë‹¤. `src`ë¥¼ ì œì™¸í•œ ê°’ì€ ëª¨ë‘ ì‚¬ìš©ì ì˜µì…˜ ê°’ì´ë‹¤.

```js
<script
  src="https://utteranc.es/client.js"
  repo="[ENTER REPO HERE]"
  issue-term="[ONE OF OPTIONS]"
  theme="[ONE OF THEMES]"
  crossorigin="anonymous"
  async
></script>
```

ìœ„ì˜ srcì˜ ê°’ "https://utteranc.es/client.js"ì„ urlì— ì…ë ¥í•´ë³´ë©´, ìƒê°ë³´ë‹¤ ì§§ì€ jsë¬¸ì„œë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.  
ê±°ê¸°ì„œ í•µì‹¬ë§Œ ì¶”ë ¤ë³´ë©´ ë‹¤ìŒê³¼ ê°™ì´ ë™ì‘í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

1. í˜„ì¬ ìŠ¤í¬ë¦½íŠ¸ ìš”ì†Œë¥¼ ê¸°ì–µí•´ë‘”ë‹¤.
2. ì‚¬ìš©ì ì˜µì…˜ì— ë”°ë¼ `<div class="utterances" />`ë¥¼ ìƒì„±í•œë‹¤.
3. ìƒì„±í•œ `<div />`ë¥¼ í˜„ì¬ ìŠ¤í¬ë¦½íŠ¸ ë’¤ì— ì¶”ê°€í•œë‹¤.
4. ìŠ¤í¬ë¦½íŠ¸ëŠ” ì‚­ì œí•œë‹¤. (giscusëŠ” ì´ ê³¼ì •ì´ ì—†ë‹¤)

```js
https: (() => {
  ...
  let r = document.currentScript    // rì€ í˜„ì¬ ìŠ¤í¬ë¦½íŠ¸ ìš”ì†Œ
  ...
  r.insertAdjacentHTML(
    'afterend',
    `<div class="utterances">\n    <iframe class="utterances-frame" title="Comments" scrolling="no" src="${h}?${new URLSearchParams(
      i
    )}" loading="lazy"></iframe>\n  </div>`
  )                                 // í˜„ì¬ ìŠ¤í¬ë¦½íŠ¸ ìš”ì†Œ ë’¤ì—, ì‹¤ì œ ì»¨í…ì¸  <div class="utterances"> ì¶”ê°€
  const m = r.nextElementSibling
  r.parentElement.removeChild(r)    // í˜„ì¬ ìŠ¤í¬ë¦½íŠ¸ ì‚­ì œ (utterances í•œì •)
  ...
})()
```

í•œë§ˆë””ë¡œ `<script/>`íƒœê·¸ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë°”ë¡œ ë’¤ì—(`afterend`)ì— ìš”ì†Œë¥¼ ì¶”ê°€í•˜ê¸° ë•Œë¬¸ì—, `<script/>`ë¥¼ ê³§ ëŒ“ê¸€ UIë¼ê³  ë³´ì•„ë„ ë¬´ë°©í•œ ê²ƒì´ë‹¤.

<img src="./images/giscus-chrome-dev.png" alt="giscus-chrome-dev.png" width=700/>

# 1. Utterances

## 1.1. ì•± ë“±ë¡ ë° script ìƒì„±

ê± [ê³µì‹ë¬¸ì„œ](https://utteranc.es/)ë¥¼ ë”°ë¼í•˜ë©´ ëœë‹¤.

## 1.2. ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸

ë‹¨ìˆœíˆ scriptíƒœê·¸ë¥¼ ì›í•˜ëŠ” ê³³ì— ì •ì ìœ¼ë¡œ ì¶”ê°€í•´ë„ ë˜ì§€ë§Œ, **ë‹¤í¬ëª¨ë“œ ë“±ì˜ ì˜µì…˜ì„ ì‚¬ìš©í•˜ë ¤ë©´ propì„ ë°›ì•„ ë™ì ìœ¼ë¡œ ë Œë”ë§í•˜ëŠ” ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ì•¼ í•œë‹¤.** ì•„ë˜ëŠ” ë‚´ê°€ ë§Œë“  Utterances ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ì´ë‹¤.

```js
import React, { createRef, useEffect } from 'react'

export interface UtterancesProps {
  theme?:
    | 'github-light'
    | 'github-dark'
    | 'preferred-color-scheme'
    | 'github-dark-orange'
    | 'icy-dark'
    | 'dark-blue'
    | 'photon-dark'
    | 'boxy-light'
    | 'gruvbox-dark'; // utterances ì§€ì› ê°€ëŠ¥ í…Œë§ˆ ëª©ë¡
}

// ì“¸ë°ì—†ëŠ” ì¬ë Œë”ë§ì´ ì¼ì–´ë‚˜ì§€ ì•ŠëŒê³  React.memo
const Utterances: React.FC<UtterancesProps> = React.memo(
  ({ theme = 'github-light' }) => {
    const utterRef = createRef < HTMLElement > null

    useEffect(() => {
      const utterance = utterRef.current
      const utterScript = document.createElement('script') // script íƒœê·¸ ìƒì„±

      // propì— ë”°ë¼ì„œ script ì†ì„± ì¶”ê°€
      const attributes = {
        src: 'https://utteranc.es/client.js',
        repo: 'byongho96/TIL',
        'issue-term': 'pathname',
        theme: theme,
        label: 'ğŸ”®commentsğŸ”®',
        crossOrigin: 'anonymous',
        async: true,
      }
      Object.entries(attributes).forEach(([key, value]) => {
        utterScript.setAttribute(key, value)
      })

      // script íƒœê·¸ DOMì— ì¶”ê°€
      utterance.appendChild(utterScript)

      return () => {
        // utternance ë‚´ë¶€ ìš”ì†Œ ì‚­ì œ í›„, ì¬ë Œë”ë§ ì‘ì—…
        utterance.childNodes.forEach((utterance) => {
          utterance.remove()
        })
      }
    }, [theme])

    return <section ref={utterRef} />
  }
)

export default Utterances
```

## 1.3. ì‚¬ìš© ì˜ˆì‹œ

ë‚˜ëŠ” Context APIë¥¼ í™œìš©í•˜ì—¬ `theme`ì„ ê´€ë¦¬í•˜ê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í–ˆë‹¤.

```js
import React, { useContext } from 'react'
import { ThemeContext } from '@contexts/theme-context'
import Utterances from '@components/utterances'

const PostPage: React.FC<PageProps> = ({ pageContext, data }) => {
  const { theme } = useContext(ThemeContext)

  return (
    <Utterances theme={theme === 'dark' ? 'github-dark' : 'github-light'} />
  )
}
```

# 2. Giscus

## 2.1. ì•± ë“±ë¡ ë° script ìƒì„±

ì—­ì‹œ ê± [ê³µì‹ë¬¸ì„œ](https://giscus.app/)ë¥¼ ë”°ë¼í•˜ë©´ ëœë‹¤. Utterancesì™€ ë‹¤ë¥´ê²Œ discussion ê¸°ëŠ¥ì„ ì—´ì–´ì£¼ëŠ” ë‹¨ê³„ê°€ ì¶”ê°€ëœë‹¤.

## 2.2. ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸

ì—­ì‹œ propì— ë”°ë¼ ë™ì ìœ¼ë¡œ ì¬ë Œë”ë§ ì‹œí‚¤ê¸° ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì—ˆë‹¤.

```js
import React, { createRef, useEffect } from 'react'

export interface GiscusProps {
  theme?:
    | 'light'
    | 'light_high_contrast'
    | 'light_protanopia'
    | 'light_tritanopia'
    | 'dark'
    | 'dark_high_contrast'
    | 'dark_protanopia'
    | 'dark_tritanopia'
    | 'dark_dimmed'
    | 'preferred_color_scheme'
    | 'transparent_dark'
    | 'noborder_light'
    | 'noborder_dark'
    | 'cobalt'  // giscus ì§€ì› ê°€ëŠ¥ í…Œë§ˆ ëª©ë¡
  lang?: 'en' | 'ko'
}

// ì“¸ë°ì—†ëŠ” ì¬ë Œë”ë§ì´ ì¼ì–´ë‚˜ì§€ ì•ŠëŒê³  React.memo
const Giscus: React.FC<GiscusProps> = React.memo(
  ({ theme = 'light', lang = 'ko' }) => {
    const giscusRef = createRef<HTMLElement>(null)

    // utternaceë¥¼ ì ìš©í•˜ê¸° ìœ„í•œ scriptë¥¼ htmlì— ì„±ìƒ
    useEffect(() => {
      const giscusContainer = giscusRef.current
      const giscusScript = document.createElement('script') // script íƒœê·¸ ìƒì„±

      // propì— ë”°ë¼ì„œ script ì†ì„± ì¶”ê°€
      const attributes = {
        src: 'https://giscus.app/client.js',
        'data-repo': 'Byongho96/TIL',
        'data-repo-id': 'R_kgDOHqT9Kw',
        'data-category': 'Announcements',
        'data-category-id': 'DIC_kwDOHqT9K84CXqXc',
        'data-mapping': 'pathname',
        'data-strict': '0',
        'data-reactions-enabled': '1',
        'data-emit-metadata': '0',
        'data-input-position': 'bottom',
        'data-theme': theme,
        'data-lang': lang,
        crossorigin: 'anonymous',
        async: true,
      }
      Object.entries(attributes).forEach(([key, value]) => {
        giscusScript.setAttribute(key, value)
      })

      // script íƒœê·¸ DOMì— ì¶”ê°€
      giscusContainer.appendChild(giscusScript)

      return () => {
        // giscuss ë‚´ë¶€ ìš”ì†Œ ì‚­ì œ í›„, ì œ ëœë”ë§
        giscusContainer.childNodes.forEach((giscusance) => {
          giscusance.remove()
        })
      }
    }, [theme, lang])

    return <section ref={giscusRef} />
  }
)

export default Giscus
```

## 2.3. ì‚¬ìš© ì˜ˆì‹œ

ë‚˜ëŠ” Context APIë¥¼ í™œìš©í•˜ì—¬ `theme`ì„ ê´€ë¦¬í•˜ê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì´ ì‚¬ìš©í–ˆë‹¤.

```js
import React, { useContext } from 'react'
import { ThemeContext } from '@contexts/theme-context'
import Giscus from '@components/giscus'

const PostPage: React.FC<PageProps> = ({ pageContext, data }) => {
  const { theme } = useContext(ThemeContext)

  return <Giscus theme={theme === 'dark' ? 'dark' : 'light'} />
}
```

## 2.4. cross-origin

GiscusëŠ” Cross Originì— ëŒ€ì‘í•˜ê¸° ìœ„í•´ giscus.json ì„¤ì •íŒŒì¼ì„ ì œê³µí•œë‹¤.

Utterancesë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” í•œ ë²ˆë„ ìƒê°í•´ë³´ì§€ ì•Šì•˜ëŠ”ë°, ê³°ê³°íˆ ìƒê°í•´ë³´ë‹ˆ Scriptë§Œ ìˆìœ¼ë©´ ì•„ë¬´ ì›¹ì‚¬ì´íŠ¸ì—ì„œ ë‚´ ë ˆí¬ì§€í† ë¦¬ì— ëŒ€í•œ ëŒ“ê¸€ UIë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤ëŠ”ê²Œ ì´ìƒí•˜ê¸°ëŠ” í•˜ë‹¤.

[ê³µì‹ë¬¸ì„œ](https://github.com/giscus/giscus/blob/main/ADVANCED-USAGE.md#giscusjson)ì˜ ì„¤ëª…ì— ë”°ë¥´ë©´, giscus.json íŒŒì´ì„ ë ˆí¬ì§€í† ë¦¬ ë£¨íŠ¸ ê²½ë¡œì— ìƒì„±í•¨ìœ¼ë¡œì¨ ì¶”ê°€ ì„¤ì •ì„ ê±¸ ìˆ˜ ìˆë‹¤ê³  í•œë‹¤. ê·¸ ì¤‘ì—ì„œ `origin`ì„¤ì •ì€ ë‚´ `<script/>`ë¥¼ ë¡œë“œí•  ìˆ˜ ìˆëŠ” ë„ë©”ì¸ì„ ì œí•œí•˜ëŠ” ì„¤ì •ì´ë‹¤.

```json
// giscus.json
{
  "origins": ["https://byongho96.github.io/TIL"]
}
```

# 3. ì°¸ì¡°

- [Utterances](https://utteranc.es/)
- [Giscus](https://giscus.app/)
- [Ricale.kr: Gatsby ë¸”ë¡œê·¸ ë§Œë“¤ê¸° 8 - ëŒ“ê¸€](https://ricale.kr/blog/posts/230211-gatsby-8-comments/)
